<BugCollection analysisTimestamp="1488587533994" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01" end="228" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" start="28" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01" end="88" endBytecode="853" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" start="35" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01" end="46" endBytecode="55" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" start="46" startBytecode="55" />
    <String role="Sink method" value="Statement.execute(...)" />
    <String role="Instruction Handle" value="  55: invokeinterface[185](5) 12" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {?}U1[1] {?}U2[0] {?}T3 {getParameter()}U4 {getDBConnection()}U5 {createStatement()}U6 {?}U7 {?}U8 {?}|U5 {createStatement()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 332) 0:    aload_1 1:    ldc  &quot;name&quot; (2) 3:    invokeinterface javax.servlet.http.HttpServletRequest.getParameter (Ljava/lang/String;)Ljava/lang/String; (3) 2 0 8:    astore_3 9:    aconst_null 10:   astore  %4 12:   aconst_null 13:   astore  %5 15:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (4) 18:   astore  %4 20:   aload  %4 22:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (5) 1 0 27:   astore  %5 29:   aload  %5 31:   new  &lt;java.lang.StringBuilder&gt; (6) 34:   dup 35:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (7) 38:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (8) 40:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 43:   aload_3 44:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 47:   ldc  &quot;'&quot; (10) 49:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 52:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (11) 55:   invokeinterface java.sql.Statement.execute (Ljava/lang/String;)Z (12) 2 0 60:   invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (13) 63:   astore  %6 65:   aload  %6 67:   invokevirtual java.lang.Boolean.booleanValue ()Z (14) 70:   ifeq  #103 73:   new  &lt;java.lang.StringBuilder&gt; (6) 76:   dup 77:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (7) 80:   ldc  &quot;Name, &quot; (15) 82:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 85:   aload_3 86:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 89:   ldc  &quot;, updated successfully&quot; (16) 91:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 94:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (11) 97:   invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (17) 100:  goto  #125 103:  new  &lt;java.lang.StringBuilder&gt; (6) 106:  dup 107:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (7) 110:  ldc  &quot;Unable to update records for user: &quot; (18) 112:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 115:  aload_3 116:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 119:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (11) 122:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (17) 125:  aload  %5 127:  ifnull  #137 130:  aload  %5 132:  invokeinterface java.sql.Statement.close ()V (19) 1 0 137:  goto  #155 140:  astore  %6 142:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 145:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 148:  ldc  &quot;Error closing Statement&quot; (23) 150:  aload  %6 152:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 155:  aload  %4 157:  ifnull  #167 160:  aload  %4 162:  invokeinterface java.sql.Connection.close ()V (25) 1 0 167:  goto  #331 170:  astore  %6 172:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 175:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 178:  ldc  &quot;Error closing Connection&quot; (26) 180:  aload  %6 182:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 185:  goto  #331 188:  astore  %6 190:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 193:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 196:  ldc  &quot;Error getting database connection&quot; (27) 198:  aload  %6 200:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 203:  aload  %5 205:  ifnull  #215 208:  aload  %5 210:  invokeinterface java.sql.Statement.close ()V (19) 1 0 215:  goto  #233 218:  astore  %6 220:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 223:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 226:  ldc  &quot;Error closing Statement&quot; (23) 228:  aload  %6 230:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 233:  aload  %4 235:  ifnull  #245 238:  aload  %4 240:  invokeinterface java.sql.Connection.close ()V (25) 1 0 245:  goto  #331 248:  astore  %6 250:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 253:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 256:  ldc  &quot;Error closing Connection&quot; (26) 258:  aload  %6 260:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 263:  goto  #331 266:  astore  %7 268:  aload  %5 270:  ifnull  #280 273:  aload  %5 275:  invokeinterface java.sql.Statement.close ()V (19) 1 0 280:  goto  #298 283:  astore  %8 285:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 288:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 291:  ldc  &quot;Error closing Statement&quot; (23) 293:  aload  %8 295:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 298:  aload  %4 300:  ifnull  #310 303:  aload  %4 305:  invokeinterface java.sql.Connection.close ()V (25) 1 0 310:  goto  #328 313:  astore  %8 315:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 318:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 321:  ldc  &quot;Error closing Connection&quot; (26) 323:  aload  %8 325:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 328:  aload  %7 330:  athrow 331:  return  Exception handler(s) =  From To Handler Type 125 137 140 java.sql.SQLException(20) 155 167 170 java.sql.SQLException(20) 15 125 188 java.sql.SQLException(20) 203 215 218 java.sql.SQLException(20) 233 245 248 java.sql.SQLException(20) 15 125 266 &lt;Any exception&gt;(0) 188 203 266 &lt;Any exception&gt;(0) 268 280 283 java.sql.SQLException(20) 298 310 313 java.sql.SQLException(20) 266 268 266 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 35), LineNumber(9, 37), LineNumber(12, 38), LineNumber(15, 42),  LineNumber(20, 43), LineNumber(29, 46), LineNumber(65, 48), LineNumber(73, 50),  LineNumber(103, 54), LineNumber(125, 65), LineNumber(130, 67), LineNumber(137, 73),  LineNumber(140, 70), LineNumber(142, 72), LineNumber(155, 77), LineNumber(160, 79),  LineNumber(167, 85), LineNumber(170, 82), LineNumber(172, 84), LineNumber(185, 86),  LineNumber(188, 57), LineNumber(190, 59), LineNumber(203, 65), LineNumber(208, 67),  LineNumber(215, 73), LineNumber(218, 70), LineNumber(220, 72), LineNumber(233, 77),  LineNumber(238, 79), LineNumber(245, 85), LineNumber(248, 82), LineNumber(250, 84),  LineNumber(263, 86), LineNumber(266, 63), LineNumber(268, 65), LineNumber(273, 67),  LineNumber(280, 73), LineNumber(283, 70), LineNumber(285, 72), LineNumber(298, 77),  LineNumber(303, 79), LineNumber(310, 85), LineNumber(313, 82), LineNumber(315, 84),  LineNumber(328, 85), LineNumber(331, 88) LocalVariable(start_pc = 65, length = 60, index = 6:Boolean result) LocalVariable(start_pc = 142, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 172, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 190, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 220, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 250, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 285, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 315, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 0, length = 332, index = 0:testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01 this) LocalVariable(start_pc = 0, length = 332, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 332, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 9, length = 323, index = 3:String data) LocalVariable(start_pc = 12, length = 320, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 15, length = 317, index = 5:java.sql.Statement sqlStatement) StackMapTable((FULL, offset delta=103, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01), (type=Object, class=javax.servlet.http.HttpServletRequest), (type=Object, class=javax.servlet.http.HttpServletResponse), (type=Object, class=java.lang.String), (type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (CHOP 2, offset delta=2)) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01" end="35" endBytecode="3" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" start="35" startBytecode="3" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_01" end="46" endBytecode="52" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_01.java" start="46" startBytecode="52" />
  </BugInstance>
  </BugCollection>