<BugCollection analysisTimestamp="1488586825920" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08" end="450" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" start="29" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08" end="121" endBytecode="1017" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" start="47" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08" end="80" endBytecode="123" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" start="80" startBytecode="123" />
    <String role="Sink method" value="Statement.execute(...)" />
    <String role="Instruction Handle" value=" 123: invokeinterface[185](5) 21" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {[?]+[[[?]+[?]]+[[?]+[?]]]}U1[1] {[?]+[[[?]+[?]]+[[?]+[?]]]}U2[0] {[?]+[[[?]+[?]]+[[?]+[?]]]}T3 {[NULL]+[[[&quot;&quot;]+[&quot;&quot;]]+[substring()]]}U4 {getDBConnection()}U5 {createStatement()}U6 {[?]+[[[?]+[?]]+[[?]+[?]]]}U7 {[?]+[[[?]+[?]]+[[?]+[?]]]}U8 {[?]+[[[?]+[?]]+[[?]+[?]]]}|U5 {createStatement()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 400) 0:    aload_0 1:    invokespecial testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08.privateReturnsTrue ()Z (2) 4:    ifeq  #68 7:    ldc  &quot;&quot; (3) 9:    astore_3 10:   new  &lt;java.util.StringTokenizer&gt; (4) 13:   dup 14:   aload_1 15:   invokeinterface javax.servlet.http.HttpServletRequest.getQueryString ()Ljava/lang/String; (5) 1 0 20:   ldc  &quot;&amp;&quot; (6) 22:   invokespecial java.util.StringTokenizer.&lt;init&gt; (Ljava/lang/String;Ljava/lang/String;)V (7) 25:   astore  %4 27:   aload  %4 29:   invokevirtual java.util.StringTokenizer.hasMoreTokens ()Z (8) 32:   ifeq  #65 35:   aload  %4 37:   invokevirtual java.util.StringTokenizer.nextToken ()Ljava/lang/String; (9) 40:   astore  %5 42:   aload  %5 44:   ldc  &quot;id=&quot; (10) 46:   invokevirtual java.lang.String.startsWith (Ljava/lang/String;)Z (11) 49:   ifeq  #62 52:   aload  %5 54:   iconst_3 55:   invokevirtual java.lang.String.substring (I)Ljava/lang/String; (12) 58:   astore_3 59:   goto  #65 62:   goto  #27 65:   goto  #70 68:   aconst_null 69:   astore_3 70:   aload_0 71:   invokespecial testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08.privateReturnsTrue ()Z (2) 74:   ifeq  #399 77:   aconst_null 78:   astore  %4 80:   aconst_null 81:   astore  %5 83:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (13) 86:   astore  %4 88:   aload  %4 90:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (14) 1 0 95:   astore  %5 97:   aload  %5 99:   new  &lt;java.lang.StringBuilder&gt; (15) 102:  dup 103:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (16) 106:  ldc  &quot;insert into users (status) values ('updated') where name='&quot; (17) 108:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 111:  aload_3 112:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 115:  ldc  &quot;'&quot; (19) 117:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 120:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (20) 123:  invokeinterface java.sql.Statement.execute (Ljava/lang/String;)Z (21) 2 0 128:  invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (22) 131:  astore  %6 133:  aload  %6 135:  invokevirtual java.lang.Boolean.booleanValue ()Z (23) 138:  ifeq  #171 141:  new  &lt;java.lang.StringBuilder&gt; (15) 144:  dup 145:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (16) 148:  ldc  &quot;Name, &quot; (24) 150:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 153:  aload_3 154:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 157:  ldc  &quot;, updated successfully&quot; (25) 159:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 162:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (20) 165:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (26) 168:  goto  #193 171:  new  &lt;java.lang.StringBuilder&gt; (15) 174:  dup 175:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (16) 178:  ldc  &quot;Unable to update records for user: &quot; (27) 180:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 183:  aload_3 184:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 187:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (20) 190:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (26) 193:  aload  %5 195:  ifnull  #205 198:  aload  %5 200:  invokeinterface java.sql.Statement.close ()V (28) 1 0 205:  goto  #223 208:  astore  %6 210:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 213:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 216:  ldc  &quot;Error closing Statement&quot; (32) 218:  aload  %6 220:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 223:  aload  %4 225:  ifnull  #235 228:  aload  %4 230:  invokeinterface java.sql.Connection.close ()V (34) 1 0 235:  goto  #399 238:  astore  %6 240:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 243:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 246:  ldc  &quot;Error closing Connection&quot; (35) 248:  aload  %6 250:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 253:  goto  #399 256:  astore  %6 258:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 261:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 264:  ldc  &quot;Error getting database connection&quot; (36) 266:  aload  %6 268:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 271:  aload  %5 273:  ifnull  #283 276:  aload  %5 278:  invokeinterface java.sql.Statement.close ()V (28) 1 0 283:  goto  #301 286:  astore  %6 288:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 291:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 294:  ldc  &quot;Error closing Statement&quot; (32) 296:  aload  %6 298:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 301:  aload  %4 303:  ifnull  #313 306:  aload  %4 308:  invokeinterface java.sql.Connection.close ()V (34) 1 0 313:  goto  #399 316:  astore  %6 318:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 321:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 324:  ldc  &quot;Error closing Connection&quot; (35) 326:  aload  %6 328:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 331:  goto  #399 334:  astore  %7 336:  aload  %5 338:  ifnull  #348 341:  aload  %5 343:  invokeinterface java.sql.Statement.close ()V (28) 1 0 348:  goto  #366 351:  astore  %8 353:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 356:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 359:  ldc  &quot;Error closing Statement&quot; (32) 361:  aload  %8 363:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 366:  aload  %4 368:  ifnull  #378 371:  aload  %4 373:  invokeinterface java.sql.Connection.close ()V (34) 1 0 378:  goto  #396 381:  astore  %8 383:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 386:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 389:  ldc  &quot;Error closing Connection&quot; (35) 391:  aload  %8 393:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 396:  aload  %7 398:  athrow 399:  return  Exception handler(s) =  From To Handler Type 193 205 208 java.sql.SQLException(29) 223 235 238 java.sql.SQLException(29) 83 193 256 java.sql.SQLException(29) 271 283 286 java.sql.SQLException(29) 301 313 316 java.sql.SQLException(29) 83 193 334 &lt;Any exception&gt;(0) 256 271 334 &lt;Any exception&gt;(0) 336 348 351 java.sql.SQLException(29) 366 378 381 java.sql.SQLException(29) 334 336 334 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 47), LineNumber(7, 49), LineNumber(10, 52), LineNumber(27, 53),  LineNumber(35, 55), LineNumber(42, 56), LineNumber(52, 58), LineNumber(59, 59),  LineNumber(62, 61), LineNumber(65, 62), LineNumber(68, 68), LineNumber(70, 71),  LineNumber(77, 73), LineNumber(80, 74), LineNumber(83, 77), LineNumber(88, 78),  LineNumber(97, 80), LineNumber(133, 81), LineNumber(141, 83), LineNumber(171, 87),  LineNumber(193, 98), LineNumber(198, 100), LineNumber(205, 106), LineNumber(208, 103),  LineNumber(210, 105), LineNumber(223, 110), LineNumber(228, 112), LineNumber(235, 118),  LineNumber(238, 115), LineNumber(240, 117), LineNumber(253, 119), LineNumber(256, 90),  LineNumber(258, 92), LineNumber(271, 98), LineNumber(276, 100), LineNumber(283, 106),  LineNumber(286, 103), LineNumber(288, 105), LineNumber(301, 110), LineNumber(306, 112),  LineNumber(313, 118), LineNumber(316, 115), LineNumber(318, 117), LineNumber(331, 119),  LineNumber(334, 96), LineNumber(336, 98), LineNumber(341, 100), LineNumber(348, 106),  LineNumber(351, 103), LineNumber(353, 105), LineNumber(366, 110), LineNumber(371, 112),  LineNumber(378, 118), LineNumber(381, 115), LineNumber(383, 117), LineNumber(396, 118),  LineNumber(399, 121) LocalVariable(start_pc = 42, length = 20, index = 5:String token) LocalVariable(start_pc = 27, length = 38, index = 4:java.util.StringTokenizer tokenizer) LocalVariable(start_pc = 10, length = 58, index = 3:String data) LocalVariable(start_pc = 133, length = 60, index = 6:Boolean result) LocalVariable(start_pc = 210, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 240, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 258, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 288, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 318, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 353, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 383, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 80, length = 319, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 83, length = 316, index = 5:java.sql.Statement sqlStatement) LocalVariable(start_pc = 0, length = 400, index = 0:testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08 this) LocalVariable(start_pc = 0, length = 400, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 400, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 70, length = 330, index = 3:String data) StackMapTable((APPEND 2, offset delta=27, locals={(type=Object, class=java.lang.String), (type=Object, class=java.util.StringTokenizer)}), (SAME, offset delta=34), (CHOP 1, offset delta=2), (CHOP 1, offset delta=2), (APPEND 1, offset delta=1, locals={(type=Object, class=java.lang.String)}), (APPEND 3, offset delta=100, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (FULL, offset delta=2, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08), (type=Object, class=javax.servlet.http.HttpServletRequest), (type=Object, class=javax.servlet.http.HttpServletResponse), (type=Object, class=java.lang.String)})) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08" end="52" endBytecode="22" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" start="52" startBytecode="22" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08" end="55" endBytecode="37" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" start="55" startBytecode="37" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08" end="58" endBytecode="55" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" start="58" startBytecode="55" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_08" end="80" endBytecode="120" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_08.java" start="80" startBytecode="120" />
  </BugInstance>
  </BugCollection>