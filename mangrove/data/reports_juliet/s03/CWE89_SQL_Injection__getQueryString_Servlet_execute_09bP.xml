<BugCollection analysisTimestamp="1488587061758" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09" end="437" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" start="29" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09" end="108" endBytecode="963" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" start="36" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09" end="67" endBytecode="104" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" start="67" startBytecode="104" />
    <String role="Sink method" value="Statement.execute(...)" />
    <String role="Instruction Handle" value=" 104: invokeinterface[185](5) 21" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {[[?]+[?]]+[[?]+[?]]}U1[1] {[[?]+[?]]+[[?]+[?]]}U2[0] {[[?]+[?]]+[[?]+[?]]}T3 {[[&quot;&quot;]+[&quot;&quot;]]+[substring()]}U4 {getDBConnection()}U5 {createStatement()}U6 {[[?]+[?]]+[[?]+[?]]}U7 {[[?]+[?]]+[[?]+[?]]}U8 {[[?]+[?]]+[[?]+[?]]}|U5 {createStatement()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 381) 0:    ldc  &quot;&quot; (3) 2:    astore_3 3:    new  &lt;java.util.StringTokenizer&gt; (4) 6:    dup 7:    aload_1 8:    invokeinterface javax.servlet.http.HttpServletRequest.getQueryString ()Ljava/lang/String; (5) 1 0 13:   ldc  &quot;&amp;&quot; (6) 15:   invokespecial java.util.StringTokenizer.&lt;init&gt; (Ljava/lang/String;Ljava/lang/String;)V (7) 18:   astore  %4 20:   aload  %4 22:   invokevirtual java.util.StringTokenizer.hasMoreTokens ()Z (8) 25:   ifeq  #58 28:   aload  %4 30:   invokevirtual java.util.StringTokenizer.nextToken ()Ljava/lang/String; (9) 33:   astore  %5 35:   aload  %5 37:   ldc  &quot;id=&quot; (10) 39:   invokevirtual java.lang.String.startsWith (Ljava/lang/String;)Z (11) 42:   ifeq  #55 45:   aload  %5 47:   iconst_3 48:   invokevirtual java.lang.String.substring (I)Ljava/lang/String; (12) 51:   astore_3 52:   goto  #58 55:   goto  #20 58:   aconst_null 59:   astore  %4 61:   aconst_null 62:   astore  %5 64:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (13) 67:   astore  %4 69:   aload  %4 71:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (14) 1 0 76:   astore  %5 78:   aload  %5 80:   new  &lt;java.lang.StringBuilder&gt; (15) 83:   dup 84:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (16) 87:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (17) 89:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 92:   aload_3 93:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 96:   ldc  &quot;'&quot; (19) 98:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 101:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (20) 104:  invokeinterface java.sql.Statement.execute (Ljava/lang/String;)Z (21) 2 0 109:  invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (22) 112:  astore  %6 114:  aload  %6 116:  invokevirtual java.lang.Boolean.booleanValue ()Z (23) 119:  ifeq  #152 122:  new  &lt;java.lang.StringBuilder&gt; (15) 125:  dup 126:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (16) 129:  ldc  &quot;Name, &quot; (24) 131:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 134:  aload_3 135:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 138:  ldc  &quot;, updated successfully&quot; (25) 140:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 143:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (20) 146:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (26) 149:  goto  #174 152:  new  &lt;java.lang.StringBuilder&gt; (15) 155:  dup 156:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (16) 159:  ldc  &quot;Unable to update records for user: &quot; (27) 161:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 164:  aload_3 165:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (18) 168:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (20) 171:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (26) 174:  aload  %5 176:  ifnull  #186 179:  aload  %5 181:  invokeinterface java.sql.Statement.close ()V (28) 1 0 186:  goto  #204 189:  astore  %6 191:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 194:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 197:  ldc  &quot;Error closing Statement&quot; (32) 199:  aload  %6 201:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 204:  aload  %4 206:  ifnull  #216 209:  aload  %4 211:  invokeinterface java.sql.Connection.close ()V (34) 1 0 216:  goto  #380 219:  astore  %6 221:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 224:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 227:  ldc  &quot;Error closing Connection&quot; (35) 229:  aload  %6 231:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 234:  goto  #380 237:  astore  %6 239:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 242:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 245:  ldc  &quot;Error getting database connection&quot; (36) 247:  aload  %6 249:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 252:  aload  %5 254:  ifnull  #264 257:  aload  %5 259:  invokeinterface java.sql.Statement.close ()V (28) 1 0 264:  goto  #282 267:  astore  %6 269:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 272:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 275:  ldc  &quot;Error closing Statement&quot; (32) 277:  aload  %6 279:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 282:  aload  %4 284:  ifnull  #294 287:  aload  %4 289:  invokeinterface java.sql.Connection.close ()V (34) 1 0 294:  goto  #380 297:  astore  %6 299:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 302:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 305:  ldc  &quot;Error closing Connection&quot; (35) 307:  aload  %6 309:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 312:  goto  #380 315:  astore  %7 317:  aload  %5 319:  ifnull  #329 322:  aload  %5 324:  invokeinterface java.sql.Statement.close ()V (28) 1 0 329:  goto  #347 332:  astore  %8 334:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 337:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 340:  ldc  &quot;Error closing Statement&quot; (32) 342:  aload  %8 344:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 347:  aload  %4 349:  ifnull  #359 352:  aload  %4 354:  invokeinterface java.sql.Connection.close ()V (34) 1 0 359:  goto  #377 362:  astore  %8 364:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 367:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 370:  ldc  &quot;Error closing Connection&quot; (35) 372:  aload  %8 374:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 377:  aload  %7 379:  athrow 380:  return  Exception handler(s) =  From To Handler Type 174 186 189 java.sql.SQLException(29) 204 216 219 java.sql.SQLException(29) 64 174 237 java.sql.SQLException(29) 252 264 267 java.sql.SQLException(29) 282 294 297 java.sql.SQLException(29) 64 174 315 &lt;Any exception&gt;(0) 237 252 315 &lt;Any exception&gt;(0) 317 329 332 java.sql.SQLException(29) 347 359 362 java.sql.SQLException(29) 315 317 315 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 36), LineNumber(3, 39), LineNumber(20, 40), LineNumber(28, 42),  LineNumber(35, 43), LineNumber(45, 45), LineNumber(52, 46), LineNumber(55, 48),  LineNumber(58, 60), LineNumber(61, 61), LineNumber(64, 64), LineNumber(69, 65),  LineNumber(78, 67), LineNumber(114, 68), LineNumber(122, 70), LineNumber(152, 74),  LineNumber(174, 85), LineNumber(179, 87), LineNumber(186, 93), LineNumber(189, 90),  LineNumber(191, 92), LineNumber(204, 97), LineNumber(209, 99), LineNumber(216, 105),  LineNumber(219, 102), LineNumber(221, 104), LineNumber(234, 106), LineNumber(237, 77),  LineNumber(239, 79), LineNumber(252, 85), LineNumber(257, 87), LineNumber(264, 93),  LineNumber(267, 90), LineNumber(269, 92), LineNumber(282, 97), LineNumber(287, 99),  LineNumber(294, 105), LineNumber(297, 102), LineNumber(299, 104), LineNumber(312, 106),  LineNumber(315, 83), LineNumber(317, 85), LineNumber(322, 87), LineNumber(329, 93),  LineNumber(332, 90), LineNumber(334, 92), LineNumber(347, 97), LineNumber(352, 99),  LineNumber(359, 105), LineNumber(362, 102), LineNumber(364, 104), LineNumber(377, 105),  LineNumber(380, 108) LocalVariable(start_pc = 35, length = 20, index = 5:String token) LocalVariable(start_pc = 20, length = 38, index = 4:java.util.StringTokenizer tokenizer) LocalVariable(start_pc = 114, length = 60, index = 6:Boolean result) LocalVariable(start_pc = 191, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 221, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 239, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 269, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 299, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 334, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 364, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 61, length = 319, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 64, length = 316, index = 5:java.sql.Statement sqlStatement) LocalVariable(start_pc = 0, length = 381, index = 0:testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09 this) LocalVariable(start_pc = 0, length = 381, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 381, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 3, length = 378, index = 3:String data) StackMapTable((APPEND 2, offset delta=20, locals={(type=Object, class=java.lang.String), (type=Object, class=java.util.StringTokenizer)}), (SAME, offset delta=34), (CHOP 1, offset delta=2), (APPEND 3, offset delta=93, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (FULL, offset delta=2, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09), (type=Object, class=javax.servlet.http.HttpServletRequest), (type=Object, class=javax.servlet.http.HttpServletResponse), (type=Object, class=java.lang.String)})) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09" end="39" endBytecode="15" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" start="39" startBytecode="15" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09" end="42" endBytecode="30" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" start="42" startBytecode="30" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09" end="45" endBytecode="48" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" start="45" startBytecode="48" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_execute_09" end="67" endBytecode="93" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_execute_09.java" start="67" startBytecode="93" />
  </BugInstance>
  </BugCollection>