<BugCollection analysisTimestamp="1488587589060" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_15">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_15" end="428" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" start="28" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_15" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_15" end="103" endBytecode="939" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" start="34" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_15" end="57" endBytecode="102" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" start="57" startBytecode="102" />
    <String role="Sink method" value="Statement.execute(...)" />
    <String role="Instruction Handle" value=" 102: invokeinterface[185](5) 12" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {[?]+[?]}U1[1] {[?]+[?]}U2[0] {[?]+[?]}T3 {[NULL]+[getParameter()]}U4 {getDBConnection()}U5 {createStatement()}U6 {[?]+[?]}U7 {[?]+[?]}U8 {[?]+[?]}|U5 {createStatement()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 387) 0:    bipush  6 2:    lookupswitch default = 32, npairs = 1 ((6, 20)) 20:   aload_1 21:   ldc  &quot;name&quot; (2) 23:   invokeinterface javax.servlet.http.HttpServletRequest.getParameter (Ljava/lang/String;)Ljava/lang/String; (3) 2 0 28:   astore_3 29:   goto  #34 32:   aconst_null 33:   astore_3 34:   bipush  7 36:   lookupswitch default = 381, npairs = 1 ((7, 56)) 56:   aconst_null 57:   astore  %4 59:   aconst_null 60:   astore  %5 62:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (4) 65:   astore  %4 67:   aload  %4 69:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (5) 1 0 74:   astore  %5 76:   aload  %5 78:   new  &lt;java.lang.StringBuilder&gt; (6) 81:   dup 82:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (7) 85:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (8) 87:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 90:   aload_3 91:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 94:   ldc  &quot;'&quot; (10) 96:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 99:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (11) 102:  invokeinterface java.sql.Statement.execute (Ljava/lang/String;)Z (12) 2 0 107:  invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (13) 110:  astore  %6 112:  aload  %6 114:  invokevirtual java.lang.Boolean.booleanValue ()Z (14) 117:  ifeq  #150 120:  new  &lt;java.lang.StringBuilder&gt; (6) 123:  dup 124:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (7) 127:  ldc  &quot;Name, &quot; (15) 129:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 132:  aload_3 133:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 136:  ldc  &quot;, updated successfully&quot; (16) 138:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 141:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (11) 144:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (17) 147:  goto  #172 150:  new  &lt;java.lang.StringBuilder&gt; (6) 153:  dup 154:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (7) 157:  ldc  &quot;Unable to update records for user: &quot; (18) 159:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 162:  aload_3 163:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (9) 166:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (11) 169:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (17) 172:  aload  %5 174:  ifnull  #184 177:  aload  %5 179:  invokeinterface java.sql.Statement.close ()V (19) 1 0 184:  goto  #202 187:  astore  %6 189:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 192:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 195:  ldc  &quot;Error closing Statement&quot; (23) 197:  aload  %6 199:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 202:  aload  %4 204:  ifnull  #214 207:  aload  %4 209:  invokeinterface java.sql.Connection.close ()V (25) 1 0 214:  goto  #378 217:  astore  %6 219:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 222:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 225:  ldc  &quot;Error closing Connection&quot; (26) 227:  aload  %6 229:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 232:  goto  #378 235:  astore  %6 237:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 240:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 243:  ldc  &quot;Error getting database connection&quot; (27) 245:  aload  %6 247:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 250:  aload  %5 252:  ifnull  #262 255:  aload  %5 257:  invokeinterface java.sql.Statement.close ()V (19) 1 0 262:  goto  #280 265:  astore  %6 267:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 270:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 273:  ldc  &quot;Error closing Statement&quot; (23) 275:  aload  %6 277:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 280:  aload  %4 282:  ifnull  #292 285:  aload  %4 287:  invokeinterface java.sql.Connection.close ()V (25) 1 0 292:  goto  #378 295:  astore  %6 297:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 300:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 303:  ldc  &quot;Error closing Connection&quot; (26) 305:  aload  %6 307:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 310:  goto  #378 313:  astore  %7 315:  aload  %5 317:  ifnull  #327 320:  aload  %5 322:  invokeinterface java.sql.Statement.close ()V (19) 1 0 327:  goto  #345 330:  astore  %8 332:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 335:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 338:  ldc  &quot;Error closing Statement&quot; (23) 340:  aload  %8 342:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 345:  aload  %4 347:  ifnull  #357 350:  aload  %4 352:  invokeinterface java.sql.Connection.close ()V (25) 1 0 357:  goto  #375 360:  astore  %8 362:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (21) 365:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (22) 368:  ldc  &quot;Error closing Connection&quot; (26) 370:  aload  %8 372:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (24) 375:  aload  %7 377:  athrow 378:  goto  #386 381:  ldc  &quot;Benign, fixed string&quot; (28) 383:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (17) 386:  return  Exception handler(s) =  From To Handler Type 172 184 187 java.sql.SQLException(20) 202 214 217 java.sql.SQLException(20) 62 172 235 java.sql.SQLException(20) 250 262 265 java.sql.SQLException(20) 280 292 295 java.sql.SQLException(20) 62 172 313 &lt;Any exception&gt;(0) 235 250 313 &lt;Any exception&gt;(0) 315 327 330 java.sql.SQLException(20) 345 357 360 java.sql.SQLException(20) 313 315 313 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 34), LineNumber(20, 38), LineNumber(29, 39), LineNumber(32, 43),  LineNumber(34, 47), LineNumber(56, 50), LineNumber(59, 51), LineNumber(62, 54),  LineNumber(67, 55), LineNumber(76, 57), LineNumber(112, 58), LineNumber(120, 60),  LineNumber(150, 64), LineNumber(172, 75), LineNumber(177, 77), LineNumber(184, 83),  LineNumber(187, 80), LineNumber(189, 82), LineNumber(202, 87), LineNumber(207, 89),  LineNumber(214, 95), LineNumber(217, 92), LineNumber(219, 94), LineNumber(232, 96),  LineNumber(235, 67), LineNumber(237, 69), LineNumber(250, 75), LineNumber(255, 77),  LineNumber(262, 83), LineNumber(265, 80), LineNumber(267, 82), LineNumber(280, 87),  LineNumber(285, 89), LineNumber(292, 95), LineNumber(295, 92), LineNumber(297, 94),  LineNumber(310, 96), LineNumber(313, 73), LineNumber(315, 75), LineNumber(320, 77),  LineNumber(327, 83), LineNumber(330, 80), LineNumber(332, 82), LineNumber(345, 87),  LineNumber(350, 89), LineNumber(357, 95), LineNumber(360, 92), LineNumber(362, 94),  LineNumber(375, 95), LineNumber(378, 97), LineNumber(381, 100), LineNumber(386, 103)  LocalVariable(start_pc = 29, length = 3, index = 3:String data) LocalVariable(start_pc = 112, length = 60, index = 6:Boolean result) LocalVariable(start_pc = 189, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 219, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 237, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 267, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 297, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 332, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 362, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 59, length = 322, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 62, length = 319, index = 5:java.sql.Statement sqlStatement) LocalVariable(start_pc = 0, length = 387, index = 0:testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_15 this) LocalVariable(start_pc = 0, length = 387, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 387, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 34, length = 353, index = 3:String data) StackMapTable((SAME, offset delta=20), (SAME, offset delta=11), (APPEND 1, offset delta=1, locals={(type=Object, class=java.lang.String)}), (SAME, offset delta=21), (APPEND 3, offset delta=93, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (CHOP 2, offset delta=2), (CHOP 2, offset delta=2), (SAME, offset delta=4)) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_15" end="38" endBytecode="23" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" start="38" startBytecode="23" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getParameter_Servlet_execute_15" end="57" endBytecode="91" sourcefile="CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getParameter_Servlet_execute_15.java" start="57" startBytecode="91" />
  </BugInstance>
  </BugCollection>