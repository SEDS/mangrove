<BugCollection analysisTimestamp="1488586180354" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" end="276" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" start="29" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" end="109" endBytecode="851" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" start="56" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" end="65" endBytecode="44" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" start="65" startBytecode="44" />
    <String role="Sink method" value="Connection.prepareStatement(...)" />
    <String role="Instruction Handle" value="  44: invokeinterface[185](5) 20" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {?}U1[1](U) {[?]+[?]}U2[0](U) {[?]+[?]}T3 {badSource()}U4 {getDBConnection()}N5 {NULL}U6 {?}U7 {?}U8 {?}|U4 {getDBConnection()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 330) 0:    aload_0 1:    aload_1 2:    aload_2 3:    invokespecial testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.badSource (Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)Ljava/lang/String; (12) 6:    astore_3 7:    aconst_null 8:    astore  %4 10:   aconst_null 11:   astore  %5 13:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (13) 16:   astore  %4 18:   aload  %4 20:   new  &lt;java.lang.StringBuilder&gt; (14) 23:   dup 24:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (15) 27:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (16) 29:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 32:   aload_3 33:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 36:   ldc  &quot;'&quot; (18) 38:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 41:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (19) 44:   invokeinterface java.sql.Connection.prepareStatement (Ljava/lang/String;)Ljava/sql/PreparedStatement; (20) 2 0 49:   astore  %5 51:   aload  %5 53:   invokeinterface java.sql.PreparedStatement.execute ()Z (21) 1 0 58:   invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (22) 61:   astore  %6 63:   aload  %6 65:   invokevirtual java.lang.Boolean.booleanValue ()Z (23) 68:   ifeq  #101 71:   new  &lt;java.lang.StringBuilder&gt; (14) 74:   dup 75:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (15) 78:   ldc  &quot;Name, &quot; (24) 80:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 83:   aload_3 84:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 87:   ldc  &quot;, updated successfully&quot; (25) 89:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 92:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (19) 95:   invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (26) 98:   goto  #123 101:  new  &lt;java.lang.StringBuilder&gt; (14) 104:  dup 105:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (15) 108:  ldc  &quot;Unable to update records for user: &quot; (27) 110:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 113:  aload_3 114:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 117:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (19) 120:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (26) 123:  aload  %5 125:  ifnull  #135 128:  aload  %5 130:  invokeinterface java.sql.PreparedStatement.close ()V (28) 1 0 135:  goto  #153 138:  astore  %6 140:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 143:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 146:  ldc  &quot;Error closing PreparedStatement&quot; (32) 148:  aload  %6 150:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 153:  aload  %4 155:  ifnull  #165 158:  aload  %4 160:  invokeinterface java.sql.Connection.close ()V (34) 1 0 165:  goto  #329 168:  astore  %6 170:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 173:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 176:  ldc  &quot;Error closing Connection&quot; (35) 178:  aload  %6 180:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 183:  goto  #329 186:  astore  %6 188:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 191:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 194:  ldc  &quot;Error getting database connection&quot; (36) 196:  aload  %6 198:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 201:  aload  %5 203:  ifnull  #213 206:  aload  %5 208:  invokeinterface java.sql.PreparedStatement.close ()V (28) 1 0 213:  goto  #231 216:  astore  %6 218:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 221:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 224:  ldc  &quot;Error closing PreparedStatement&quot; (32) 226:  aload  %6 228:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 231:  aload  %4 233:  ifnull  #243 236:  aload  %4 238:  invokeinterface java.sql.Connection.close ()V (34) 1 0 243:  goto  #329 246:  astore  %6 248:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 251:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 254:  ldc  &quot;Error closing Connection&quot; (35) 256:  aload  %6 258:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 261:  goto  #329 264:  astore  %7 266:  aload  %5 268:  ifnull  #278 271:  aload  %5 273:  invokeinterface java.sql.PreparedStatement.close ()V (28) 1 0 278:  goto  #296 281:  astore  %8 283:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 286:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 289:  ldc  &quot;Error closing PreparedStatement&quot; (32) 291:  aload  %8 293:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 296:  aload  %4 298:  ifnull  #308 301:  aload  %4 303:  invokeinterface java.sql.Connection.close ()V (34) 1 0 308:  goto  #326 311:  astore  %8 313:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 316:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 319:  ldc  &quot;Error closing Connection&quot; (35) 321:  aload  %8 323:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 326:  aload  %7 328:  athrow 329:  return  Exception handler(s) =  From To Handler Type 123 135 138 java.sql.SQLException(29) 153 165 168 java.sql.SQLException(29) 13 123 186 java.sql.SQLException(29) 201 213 216 java.sql.SQLException(29) 231 243 246 java.sql.SQLException(29) 13 123 264 &lt;Any exception&gt;(0) 186 201 264 &lt;Any exception&gt;(0) 266 278 281 java.sql.SQLException(29) 296 308 311 java.sql.SQLException(29) 264 266 264 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 56), LineNumber(7, 58), LineNumber(10, 59), LineNumber(13, 64),  LineNumber(18, 65), LineNumber(51, 67), LineNumber(63, 69), LineNumber(71, 71),  LineNumber(101, 75), LineNumber(123, 86), LineNumber(128, 88), LineNumber(135, 94),  LineNumber(138, 91), LineNumber(140, 93), LineNumber(153, 98), LineNumber(158, 100),  LineNumber(165, 106), LineNumber(168, 103), LineNumber(170, 105), LineNumber(183, 107),  LineNumber(186, 78), LineNumber(188, 80), LineNumber(201, 86), LineNumber(206, 88),  LineNumber(213, 94), LineNumber(216, 91), LineNumber(218, 93), LineNumber(231, 98),  LineNumber(236, 100), LineNumber(243, 106), LineNumber(246, 103), LineNumber(248, 105),  LineNumber(261, 107), LineNumber(264, 84), LineNumber(266, 86), LineNumber(271, 88),  LineNumber(278, 94), LineNumber(281, 91), LineNumber(283, 93), LineNumber(296, 98),  LineNumber(301, 100), LineNumber(308, 106), LineNumber(311, 103), LineNumber(313, 105),  LineNumber(326, 106), LineNumber(329, 109) LocalVariable(start_pc = 63, length = 60, index = 6:Boolean result) LocalVariable(start_pc = 140, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 170, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 188, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 218, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 248, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 283, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 313, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 0, length = 330, index = 0:testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42 this) LocalVariable(start_pc = 0, length = 330, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 330, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 7, length = 323, index = 3:String data) LocalVariable(start_pc = 10, length = 320, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 13, length = 317, index = 5:java.sql.PreparedStatement sqlStatement) StackMapTable((FULL, offset delta=101, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42), (type=Object, class=javax.servlet.http.HttpServletRequest), (type=Object, class=javax.servlet.http.HttpServletResponse), (type=Object, class=java.lang.String), (type=Object, class=java.sql.Connection), (type=Object, class=java.sql.PreparedStatement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (CHOP 2, offset delta=2)) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" end="39" endBytecode="8" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" start="39" startBytecode="8" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" end="42" endBytecode="30" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" start="42" startBytecode="30" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" end="45" endBytecode="48" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" start="45" startBytecode="48" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" end="56" endBytecode="3" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" start="56" startBytecode="3" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42" end="65" endBytecode="33" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_42.java" start="65" startBytecode="33" />
  </BugInstance>
  </BugCollection>