<BugCollection analysisTimestamp="1488585998380" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11" end="438" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" start="29" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11" end="108" endBytecode="1015" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" start="34" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11" end="66" endBytecode="112" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" start="66" startBytecode="112" />
    <String role="Sink method" value="Connection.prepareStatement(...)" />
    <String role="Instruction Handle" value=" 112: invokeinterface[185](5) 20" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {[?]+[[[?]+[?]]+[[?]+[?]]]}U1[1] {[?]+[[[?]+[?]]+[[?]+[?]]]}U2[0] {[?]+[[[?]+[?]]+[[?]+[?]]]}T3 {[NULL]+[[[&quot;&quot;]+[&quot;&quot;]]+[substring()]]}U4 {getDBConnection()}N5 {NULL}U6 {[?]+[[[?]+[?]]+[[?]+[?]]]}U7 {[?]+[[[?]+[?]]+[[?]+[?]]]}U8 {[?]+[[[?]+[?]]+[[?]+[?]]]}|U4 {getDBConnection()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 398) 0:    invokestatic testcasesupport.IO.staticReturnsTrue ()Z (2) 3:    ifeq  #67 6:    ldc  &quot;&quot; (3) 8:    astore_3 9:    new  &lt;java.util.StringTokenizer&gt; (4) 12:   dup 13:   aload_1 14:   invokeinterface javax.servlet.http.HttpServletRequest.getQueryString ()Ljava/lang/String; (5) 1 0 19:   ldc  &quot;&amp;&quot; (6) 21:   invokespecial java.util.StringTokenizer.&lt;init&gt; (Ljava/lang/String;Ljava/lang/String;)V (7) 24:   astore  %4 26:   aload  %4 28:   invokevirtual java.util.StringTokenizer.hasMoreTokens ()Z (8) 31:   ifeq  #64 34:   aload  %4 36:   invokevirtual java.util.StringTokenizer.nextToken ()Ljava/lang/String; (9) 39:   astore  %5 41:   aload  %5 43:   ldc  &quot;id=&quot; (10) 45:   invokevirtual java.lang.String.startsWith (Ljava/lang/String;)Z (11) 48:   ifeq  #61 51:   aload  %5 53:   iconst_3 54:   invokevirtual java.lang.String.substring (I)Ljava/lang/String; (12) 57:   astore_3 58:   goto  #64 61:   goto  #26 64:   goto  #69 67:   aconst_null 68:   astore_3 69:   invokestatic testcasesupport.IO.staticReturnsTrue ()Z (2) 72:   ifeq  #397 75:   aconst_null 76:   astore  %4 78:   aconst_null 79:   astore  %5 81:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (13) 84:   astore  %4 86:   aload  %4 88:   new  &lt;java.lang.StringBuilder&gt; (14) 91:   dup 92:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (15) 95:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (16) 97:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 100:  aload_3 101:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 104:  ldc  &quot;'&quot; (18) 106:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 109:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (19) 112:  invokeinterface java.sql.Connection.prepareStatement (Ljava/lang/String;)Ljava/sql/PreparedStatement; (20) 2 0 117:  astore  %5 119:  aload  %5 121:  invokeinterface java.sql.PreparedStatement.execute ()Z (21) 1 0 126:  invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (22) 129:  astore  %6 131:  aload  %6 133:  invokevirtual java.lang.Boolean.booleanValue ()Z (23) 136:  ifeq  #169 139:  new  &lt;java.lang.StringBuilder&gt; (14) 142:  dup 143:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (15) 146:  ldc  &quot;Name, &quot; (24) 148:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 151:  aload_3 152:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 155:  ldc  &quot;, updated successfully&quot; (25) 157:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 160:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (19) 163:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (26) 166:  goto  #191 169:  new  &lt;java.lang.StringBuilder&gt; (14) 172:  dup 173:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (15) 176:  ldc  &quot;Unable to update records for user: &quot; (27) 178:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 181:  aload_3 182:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (17) 185:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (19) 188:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (26) 191:  aload  %5 193:  ifnull  #203 196:  aload  %5 198:  invokeinterface java.sql.PreparedStatement.close ()V (28) 1 0 203:  goto  #221 206:  astore  %6 208:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 211:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 214:  ldc  &quot;Error closing PreparedStatement&quot; (32) 216:  aload  %6 218:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 221:  aload  %4 223:  ifnull  #233 226:  aload  %4 228:  invokeinterface java.sql.Connection.close ()V (34) 1 0 233:  goto  #397 236:  astore  %6 238:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 241:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 244:  ldc  &quot;Error closing Connection&quot; (35) 246:  aload  %6 248:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 251:  goto  #397 254:  astore  %6 256:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 259:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 262:  ldc  &quot;Error getting database connection&quot; (36) 264:  aload  %6 266:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 269:  aload  %5 271:  ifnull  #281 274:  aload  %5 276:  invokeinterface java.sql.PreparedStatement.close ()V (28) 1 0 281:  goto  #299 284:  astore  %6 286:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 289:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 292:  ldc  &quot;Error closing PreparedStatement&quot; (32) 294:  aload  %6 296:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 299:  aload  %4 301:  ifnull  #311 304:  aload  %4 306:  invokeinterface java.sql.Connection.close ()V (34) 1 0 311:  goto  #397 314:  astore  %6 316:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 319:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 322:  ldc  &quot;Error closing Connection&quot; (35) 324:  aload  %6 326:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 329:  goto  #397 332:  astore  %7 334:  aload  %5 336:  ifnull  #346 339:  aload  %5 341:  invokeinterface java.sql.PreparedStatement.close ()V (28) 1 0 346:  goto  #364 349:  astore  %8 351:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 354:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 357:  ldc  &quot;Error closing PreparedStatement&quot; (32) 359:  aload  %8 361:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 364:  aload  %4 366:  ifnull  #376 369:  aload  %4 371:  invokeinterface java.sql.Connection.close ()V (34) 1 0 376:  goto  #394 379:  astore  %8 381:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (30) 384:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (31) 387:  ldc  &quot;Error closing Connection&quot; (35) 389:  aload  %8 391:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (33) 394:  aload  %7 396:  athrow 397:  return  Exception handler(s) =  From To Handler Type 191 203 206 java.sql.SQLException(29) 221 233 236 java.sql.SQLException(29) 81 191 254 java.sql.SQLException(29) 269 281 284 java.sql.SQLException(29) 299 311 314 java.sql.SQLException(29) 81 191 332 &lt;Any exception&gt;(0) 254 269 332 &lt;Any exception&gt;(0) 334 346 349 java.sql.SQLException(29) 364 376 379 java.sql.SQLException(29) 332 334 332 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 34), LineNumber(6, 36), LineNumber(9, 39), LineNumber(26, 40),  LineNumber(34, 42), LineNumber(41, 43), LineNumber(51, 45), LineNumber(58, 46),  LineNumber(61, 48), LineNumber(64, 49), LineNumber(67, 55), LineNumber(69, 58),  LineNumber(75, 60), LineNumber(78, 61), LineNumber(81, 65), LineNumber(86, 66),  LineNumber(119, 67), LineNumber(131, 68), LineNumber(139, 70), LineNumber(169, 74),  LineNumber(191, 85), LineNumber(196, 87), LineNumber(203, 93), LineNumber(206, 90),  LineNumber(208, 92), LineNumber(221, 97), LineNumber(226, 99), LineNumber(233, 105),  LineNumber(236, 102), LineNumber(238, 104), LineNumber(251, 106), LineNumber(254, 77),  LineNumber(256, 79), LineNumber(269, 85), LineNumber(274, 87), LineNumber(281, 93),  LineNumber(284, 90), LineNumber(286, 92), LineNumber(299, 97), LineNumber(304, 99),  LineNumber(311, 105), LineNumber(314, 102), LineNumber(316, 104), LineNumber(329, 106),  LineNumber(332, 83), LineNumber(334, 85), LineNumber(339, 87), LineNumber(346, 93),  LineNumber(349, 90), LineNumber(351, 92), LineNumber(364, 97), LineNumber(369, 99),  LineNumber(376, 105), LineNumber(379, 102), LineNumber(381, 104), LineNumber(394, 105),  LineNumber(397, 108) LocalVariable(start_pc = 41, length = 20, index = 5:String token) LocalVariable(start_pc = 26, length = 38, index = 4:java.util.StringTokenizer tokenizer) LocalVariable(start_pc = 9, length = 58, index = 3:String data) LocalVariable(start_pc = 131, length = 60, index = 6:Boolean result) LocalVariable(start_pc = 208, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 238, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 256, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 286, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 316, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 351, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 381, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 78, length = 319, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 81, length = 316, index = 5:java.sql.PreparedStatement sqlStatement) LocalVariable(start_pc = 0, length = 398, index = 0:testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11 this) LocalVariable(start_pc = 0, length = 398, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 398, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 69, length = 329, index = 3:String data) StackMapTable((APPEND 2, offset delta=26, locals={(type=Object, class=java.lang.String), (type=Object, class=java.util.StringTokenizer)}), (SAME, offset delta=34), (CHOP 1, offset delta=2), (CHOP 1, offset delta=2), (APPEND 1, offset delta=1, locals={(type=Object, class=java.lang.String)}), (APPEND 3, offset delta=99, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.PreparedStatement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (FULL, offset delta=2, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11), (type=Object, class=javax.servlet.http.HttpServletRequest), (type=Object, class=javax.servlet.http.HttpServletResponse), (type=Object, class=java.lang.String)})) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11" end="39" endBytecode="21" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" start="39" startBytecode="21" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11" end="42" endBytecode="36" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" start="42" startBytecode="36" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11" end="45" endBytecode="54" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" start="45" startBytecode="54" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s03.CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11" end="66" endBytecode="101" sourcefile="CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s03/CWE89_SQL_Injection__getQueryString_Servlet_prepareStatement_11.java" start="66" startBytecode="101" />
  </BugInstance>
  </BugCollection>