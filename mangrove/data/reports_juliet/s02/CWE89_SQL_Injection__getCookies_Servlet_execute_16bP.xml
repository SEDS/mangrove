<BugCollection analysisTimestamp="1488586591300" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_execute_16">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_execute_16" end="257" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" start="28" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_execute_16" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_execute_16" end="100" endBytecode="891" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" start="36" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_execute_16" end="58" endBytecode="70" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" start="58" startBytecode="70" />
    <String role="Sink method" value="Statement.execute(...)" />
    <String role="Instruction Handle" value="  70: invokeinterface[185](5) 13" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {[?]+[?]}U1[1] {[?]+[?]}U2[0] {[?]+[?]}T3 {[&quot;&quot;]+[getValue()]}U4 {getDBConnection()}U5 {createStatement()}U6 {[?]+[?]}U7 {[?]+[?]}U8 {[?]+[?]}|U5 {createStatement()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 350) 0:    ldc  &quot;&quot; (2) 2:    astore_3 3:    aload_1 4:    invokeinterface javax.servlet.http.HttpServletRequest.getCookies ()[Ljavax/servlet/http/Cookie; (3) 1 0 9:    astore  %4 11:   aload  %4 13:   ifnull  #24 16:   aload  %4 18:   iconst_0 19:   aaload 20:   invokevirtual javax.servlet.http.Cookie.getValue ()Ljava/lang/String; (4) 23:   astore_3 24:   aconst_null 25:   astore  %4 27:   aconst_null 28:   astore  %5 30:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (5) 33:   astore  %4 35:   aload  %4 37:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (6) 1 0 42:   astore  %5 44:   aload  %5 46:   new  &lt;java.lang.StringBuilder&gt; (7) 49:   dup 50:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (8) 53:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (9) 55:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 58:   aload_3 59:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 62:   ldc  &quot;'&quot; (11) 64:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 67:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (12) 70:   invokeinterface java.sql.Statement.execute (Ljava/lang/String;)Z (13) 2 0 75:   invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (14) 78:   astore  %6 80:   aload  %6 82:   invokevirtual java.lang.Boolean.booleanValue ()Z (15) 85:   ifeq  #118 88:   new  &lt;java.lang.StringBuilder&gt; (7) 91:   dup 92:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (8) 95:   ldc  &quot;Name, &quot; (16) 97:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 100:  aload_3 101:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 104:  ldc  &quot;, updated successfully&quot; (17) 106:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 109:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (12) 112:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (18) 115:  goto  #140 118:  new  &lt;java.lang.StringBuilder&gt; (7) 121:  dup 122:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (8) 125:  ldc  &quot;Unable to update records for user: &quot; (19) 127:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 130:  aload_3 131:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 134:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (12) 137:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (18) 140:  aload  %5 142:  ifnull  #152 145:  aload  %5 147:  invokeinterface java.sql.Statement.close ()V (20) 1 0 152:  goto  #170 155:  astore  %6 157:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (22) 160:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (23) 163:  ldc  &quot;Error closing Statement&quot; (24) 165:  aload  %6 167:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (25) 170:  aload  %4 172:  ifnull  #182 175:  aload  %4 177:  invokeinterface java.sql.Connection.close ()V (26) 1 0 182:  goto  #346 185:  astore  %6 187:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (22) 190:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (23) 193:  ldc  &quot;Error closing Connection&quot; (27) 195:  aload  %6 197:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (25) 200:  goto  #346 203:  astore  %6 205:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (22) 208:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (23) 211:  ldc  &quot;Error getting database connection&quot; (28) 213:  aload  %6 215:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (25) 218:  aload  %5 220:  ifnull  #230 223:  aload  %5 225:  invokeinterface java.sql.Statement.close ()V (20) 1 0 230:  goto  #248 233:  astore  %6 235:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (22) 238:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (23) 241:  ldc  &quot;Error closing Statement&quot; (24) 243:  aload  %6 245:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (25) 248:  aload  %4 250:  ifnull  #260 253:  aload  %4 255:  invokeinterface java.sql.Connection.close ()V (26) 1 0 260:  goto  #346 263:  astore  %6 265:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (22) 268:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (23) 271:  ldc  &quot;Error closing Connection&quot; (27) 273:  aload  %6 275:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (25) 278:  goto  #346 281:  astore  %7 283:  aload  %5 285:  ifnull  #295 288:  aload  %5 290:  invokeinterface java.sql.Statement.close ()V (20) 1 0 295:  goto  #313 298:  astore  %8 300:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (22) 303:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (23) 306:  ldc  &quot;Error closing Statement&quot; (24) 308:  aload  %8 310:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (25) 313:  aload  %4 315:  ifnull  #325 318:  aload  %4 320:  invokeinterface java.sql.Connection.close ()V (26) 1 0 325:  goto  #343 328:  astore  %8 330:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (22) 333:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (23) 336:  ldc  &quot;Error closing Connection&quot; (27) 338:  aload  %8 340:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (25) 343:  aload  %7 345:  athrow 346:  goto  #349 349:  return  Exception handler(s) =  From To Handler Type 140 152 155 java.sql.SQLException(21) 170 182 185 java.sql.SQLException(21) 30 140 203 java.sql.SQLException(21) 218 230 233 java.sql.SQLException(21) 248 260 263 java.sql.SQLException(21) 30 140 281 &lt;Any exception&gt;(0) 203 218 281 &lt;Any exception&gt;(0) 283 295 298 java.sql.SQLException(21) 313 325 328 java.sql.SQLException(21) 281 283 281 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 36), LineNumber(3, 39), LineNumber(11, 40), LineNumber(16, 43),  LineNumber(24, 51), LineNumber(27, 52), LineNumber(30, 55), LineNumber(35, 56),  LineNumber(44, 58), LineNumber(80, 59), LineNumber(88, 61), LineNumber(118, 65),  LineNumber(140, 76), LineNumber(145, 78), LineNumber(152, 84), LineNumber(155, 81),  LineNumber(157, 83), LineNumber(170, 88), LineNumber(175, 90), LineNumber(182, 96),  LineNumber(185, 93), LineNumber(187, 95), LineNumber(200, 97), LineNumber(203, 68),  LineNumber(205, 70), LineNumber(218, 76), LineNumber(223, 78), LineNumber(230, 84),  LineNumber(233, 81), LineNumber(235, 83), LineNumber(248, 88), LineNumber(253, 90),  LineNumber(260, 96), LineNumber(263, 93), LineNumber(265, 95), LineNumber(278, 97),  LineNumber(281, 74), LineNumber(283, 76), LineNumber(288, 78), LineNumber(295, 84),  LineNumber(298, 81), LineNumber(300, 83), LineNumber(313, 88), LineNumber(318, 90),  LineNumber(325, 96), LineNumber(328, 93), LineNumber(330, 95), LineNumber(343, 96),  LineNumber(346, 98), LineNumber(349, 100) LocalVariable(start_pc = 11, length = 13, index = 4:javax.servlet.http.Cookie[] cookieSources) LocalVariable(start_pc = 80, length = 60, index = 6:Boolean result) LocalVariable(start_pc = 157, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 187, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 205, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 235, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 265, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 300, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 330, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 27, length = 322, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 30, length = 319, index = 5:java.sql.Statement sqlStatement) LocalVariable(start_pc = 0, length = 350, index = 0:testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_execute_16 this) LocalVariable(start_pc = 0, length = 350, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 350, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 3, length = 347, index = 3:String data) StackMapTable((SAME, offset delta=0), (APPEND 1, offset delta=23, locals={(type=Object, class=java.lang.String)}), (APPEND 3, offset delta=93, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (CHOP 2, offset delta=2), (CHOP 2, offset delta=2)) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_execute_16" end="43" endBytecode="20" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" start="43" startBytecode="20" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_execute_16" end="58" endBytecode="67" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_execute_16.java" start="58" startBytecode="67" />
  </BugInstance>
  </BugCollection>