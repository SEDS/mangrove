<BugCollection analysisTimestamp="1488586738596" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="2" rank="12" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad" end="76" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad.java" start="27" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad" isStatic="false" name="action" signature="(Ljava/lang/String;Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad" end="76" endBytecode="774" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad.java" start="32" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad" end="41" endBytecode="46" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad.java" start="41" startBytecode="46" />
    <String role="Sink method" value="Statement.executeUpdate(...)" />
    <String role="Instruction Handle" value="  46: invokeinterface[185](5) 10" />
    <String role="Parameter Taint" value="U[2](S) {toString()}" />
    <String role="Taint Frame" value="[U0[3] {?}U1[2] {?}U2[1] {?}U3[0] {?}U4 {getDBConnection()}U5 {createStatement()}U6 {?}U7 {?}U8 {?}|U5 {createStatement()}U[2](S) {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 288) 0:    aconst_null 1:    astore  %4 3:    aconst_null 4:    astore  %5 6:    invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (2) 9:    astore  %4 11:   aload  %4 13:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (3) 1 0 18:   astore  %5 20:   aload  %5 22:   new  &lt;java.lang.StringBuilder&gt; (4) 25:   dup 26:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (5) 29:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (6) 31:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (7) 34:   aload_1 35:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (7) 38:   ldc  &quot;'&quot; (8) 40:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (7) 43:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (9) 46:   invokeinterface java.sql.Statement.executeUpdate (Ljava/lang/String;)I (10) 2 0 51:   istore  %6 53:   new  &lt;java.lang.StringBuilder&gt; (4) 56:   dup 57:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (5) 60:   ldc  &quot;Updated &quot; (11) 62:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (7) 65:   iload  %6 67:   invokevirtual java.lang.StringBuilder.append (I)Ljava/lang/StringBuilder; (12) 70:   ldc  &quot; rows successfully.&quot; (13) 72:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (7) 75:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (9) 78:   invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (14) 81:   aload  %5 83:   ifnull  #93 86:   aload  %5 88:   invokeinterface java.sql.Statement.close ()V (15) 1 0 93:   goto  #111 96:   astore  %6 98:   getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (17) 101:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (18) 104:  ldc  &quot;Error closing Statement&quot; (19) 106:  aload  %6 108:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (20) 111:  aload  %4 113:  ifnull  #123 116:  aload  %4 118:  invokeinterface java.sql.Connection.close ()V (21) 1 0 123:  goto  #287 126:  astore  %6 128:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (17) 131:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (18) 134:  ldc  &quot;Error closing Connection&quot; (22) 136:  aload  %6 138:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (20) 141:  goto  #287 144:  astore  %6 146:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (17) 149:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (18) 152:  ldc  &quot;Error getting database connection&quot; (23) 154:  aload  %6 156:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (20) 159:  aload  %5 161:  ifnull  #171 164:  aload  %5 166:  invokeinterface java.sql.Statement.close ()V (15) 1 0 171:  goto  #189 174:  astore  %6 176:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (17) 179:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (18) 182:  ldc  &quot;Error closing Statement&quot; (19) 184:  aload  %6 186:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (20) 189:  aload  %4 191:  ifnull  #201 194:  aload  %4 196:  invokeinterface java.sql.Connection.close ()V (21) 1 0 201:  goto  #287 204:  astore  %6 206:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (17) 209:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (18) 212:  ldc  &quot;Error closing Connection&quot; (22) 214:  aload  %6 216:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (20) 219:  goto  #287 222:  astore  %7 224:  aload  %5 226:  ifnull  #236 229:  aload  %5 231:  invokeinterface java.sql.Statement.close ()V (15) 1 0 236:  goto  #254 239:  astore  %8 241:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (17) 244:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (18) 247:  ldc  &quot;Error closing Statement&quot; (19) 249:  aload  %8 251:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (20) 254:  aload  %4 256:  ifnull  #266 259:  aload  %4 261:  invokeinterface java.sql.Connection.close ()V (21) 1 0 266:  goto  #284 269:  astore  %8 271:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (17) 274:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (18) 277:  ldc  &quot;Error closing Connection&quot; (22) 279:  aload  %8 281:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (20) 284:  aload  %7 286:  athrow 287:  return  Exception handler(s) =  From To Handler Type 81 93 96 java.sql.SQLException(16) 111 123 126 java.sql.SQLException(16) 6 81 144 java.sql.SQLException(16) 159 171 174 java.sql.SQLException(16) 189 201 204 java.sql.SQLException(16) 6 81 222 &lt;Any exception&gt;(0) 144 159 222 &lt;Any exception&gt;(0) 224 236 239 java.sql.SQLException(16) 254 266 269 java.sql.SQLException(16) 222 224 222 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 32), LineNumber(3, 33), LineNumber(6, 37), LineNumber(11, 38),  LineNumber(20, 41), LineNumber(53, 43), LineNumber(81, 53), LineNumber(86, 55),  LineNumber(93, 61), LineNumber(96, 58), LineNumber(98, 60), LineNumber(111, 65),  LineNumber(116, 67), LineNumber(123, 73), LineNumber(126, 70), LineNumber(128, 72),  LineNumber(141, 74), LineNumber(144, 45), LineNumber(146, 47), LineNumber(159, 53),  LineNumber(164, 55), LineNumber(171, 61), LineNumber(174, 58), LineNumber(176, 60),  LineNumber(189, 65), LineNumber(194, 67), LineNumber(201, 73), LineNumber(204, 70),  LineNumber(206, 72), LineNumber(219, 74), LineNumber(222, 51), LineNumber(224, 53),  LineNumber(229, 55), LineNumber(236, 61), LineNumber(239, 58), LineNumber(241, 60),  LineNumber(254, 65), LineNumber(259, 67), LineNumber(266, 73), LineNumber(269, 70),  LineNumber(271, 72), LineNumber(284, 73), LineNumber(287, 76) LocalVariable(start_pc = 53, length = 28, index = 6:int rowCount) LocalVariable(start_pc = 98, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 128, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 146, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 176, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 206, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 241, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 271, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 0, length = 288, index = 0:testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad this) LocalVariable(start_pc = 0, length = 288, index = 1:String data) LocalVariable(start_pc = 0, length = 288, index = 2:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 288, index = 3:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 3, length = 285, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 6, length = 282, index = 5:java.sql.Statement sqlStatement) StackMapTable((APPEND 2, offset delta=93, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (CHOP 2, offset delta=2)) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad" end="41" endBytecode="35" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_81_bad.java" start="41" startBytecode="35" />
  </BugInstance>
  </BugCollection>