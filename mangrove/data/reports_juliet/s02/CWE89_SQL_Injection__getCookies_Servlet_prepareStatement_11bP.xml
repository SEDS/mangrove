<BugCollection analysisTimestamp="1488586427982" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11" end="425" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" start="28" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11" end="103" endBytecode="948" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" start="33" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11" end="61" endBytecode="78" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" start="61" startBytecode="78" />
    <String role="Sink method" value="Connection.prepareStatement(...)" />
    <String role="Instruction Handle" value="  78: invokeinterface[185](5) 13" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {[?]+[[?]+[?]]}U1[1] {[?]+[[?]+[?]]}U2[0] {[?]+[[?]+[?]]}T3 {[NULL]+[[&quot;&quot;]+[getValue()]]}U4 {getDBConnection()}N5 {NULL}U6 {[?]+[[?]+[?]]}U7 {[?]+[[?]+[?]]}U8 {[?]+[[?]+[?]]}|U4 {getDBConnection()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 364) 0:    invokestatic testcasesupport.IO.staticReturnsTrue ()Z (2) 3:    ifeq  #33 6:    ldc  &quot;&quot; (3) 8:    astore_3 9:    aload_1 10:   invokeinterface javax.servlet.http.HttpServletRequest.getCookies ()[Ljavax/servlet/http/Cookie; (4) 1 0 15:   astore  %4 17:   aload  %4 19:   ifnull  #30 22:   aload  %4 24:   iconst_0 25:   aaload 26:   invokevirtual javax.servlet.http.Cookie.getValue ()Ljava/lang/String; (5) 29:   astore_3 30:   goto  #35 33:   aconst_null 34:   astore_3 35:   invokestatic testcasesupport.IO.staticReturnsTrue ()Z (2) 38:   ifeq  #363 41:   aconst_null 42:   astore  %4 44:   aconst_null 45:   astore  %5 47:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (6) 50:   astore  %4 52:   aload  %4 54:   new  &lt;java.lang.StringBuilder&gt; (7) 57:   dup 58:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (8) 61:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (9) 63:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 66:   aload_3 67:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 70:   ldc  &quot;'&quot; (11) 72:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 75:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (12) 78:   invokeinterface java.sql.Connection.prepareStatement (Ljava/lang/String;)Ljava/sql/PreparedStatement; (13) 2 0 83:   astore  %5 85:   aload  %5 87:   invokeinterface java.sql.PreparedStatement.execute ()Z (14) 1 0 92:   invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (15) 95:   astore  %6 97:   aload  %6 99:   invokevirtual java.lang.Boolean.booleanValue ()Z (16) 102:  ifeq  #135 105:  new  &lt;java.lang.StringBuilder&gt; (7) 108:  dup 109:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (8) 112:  ldc  &quot;Name, &quot; (17) 114:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 117:  aload_3 118:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 121:  ldc  &quot;, updated successfully&quot; (18) 123:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 126:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (12) 129:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (19) 132:  goto  #157 135:  new  &lt;java.lang.StringBuilder&gt; (7) 138:  dup 139:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (8) 142:  ldc  &quot;Unable to update records for user: &quot; (20) 144:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 147:  aload_3 148:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 151:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (12) 154:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (19) 157:  aload  %5 159:  ifnull  #169 162:  aload  %5 164:  invokeinterface java.sql.PreparedStatement.close ()V (21) 1 0 169:  goto  #187 172:  astore  %6 174:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (23) 177:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (24) 180:  ldc  &quot;Error closing PreparedStatement&quot; (25) 182:  aload  %6 184:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (26) 187:  aload  %4 189:  ifnull  #199 192:  aload  %4 194:  invokeinterface java.sql.Connection.close ()V (27) 1 0 199:  goto  #363 202:  astore  %6 204:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (23) 207:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (24) 210:  ldc  &quot;Error closing Connection&quot; (28) 212:  aload  %6 214:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (26) 217:  goto  #363 220:  astore  %6 222:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (23) 225:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (24) 228:  ldc  &quot;Error getting database connection&quot; (29) 230:  aload  %6 232:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (26) 235:  aload  %5 237:  ifnull  #247 240:  aload  %5 242:  invokeinterface java.sql.PreparedStatement.close ()V (21) 1 0 247:  goto  #265 250:  astore  %6 252:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (23) 255:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (24) 258:  ldc  &quot;Error closing PreparedStatement&quot; (25) 260:  aload  %6 262:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (26) 265:  aload  %4 267:  ifnull  #277 270:  aload  %4 272:  invokeinterface java.sql.Connection.close ()V (27) 1 0 277:  goto  #363 280:  astore  %6 282:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (23) 285:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (24) 288:  ldc  &quot;Error closing Connection&quot; (28) 290:  aload  %6 292:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (26) 295:  goto  #363 298:  astore  %7 300:  aload  %5 302:  ifnull  #312 305:  aload  %5 307:  invokeinterface java.sql.PreparedStatement.close ()V (21) 1 0 312:  goto  #330 315:  astore  %8 317:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (23) 320:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (24) 323:  ldc  &quot;Error closing PreparedStatement&quot; (25) 325:  aload  %8 327:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (26) 330:  aload  %4 332:  ifnull  #342 335:  aload  %4 337:  invokeinterface java.sql.Connection.close ()V (27) 1 0 342:  goto  #360 345:  astore  %8 347:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (23) 350:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (24) 353:  ldc  &quot;Error closing Connection&quot; (28) 355:  aload  %8 357:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (26) 360:  aload  %7 362:  athrow 363:  return  Exception handler(s) =  From To Handler Type 157 169 172 java.sql.SQLException(22) 187 199 202 java.sql.SQLException(22) 47 157 220 java.sql.SQLException(22) 235 247 250 java.sql.SQLException(22) 265 277 280 java.sql.SQLException(22) 47 157 298 &lt;Any exception&gt;(0) 220 235 298 &lt;Any exception&gt;(0) 300 312 315 java.sql.SQLException(22) 330 342 345 java.sql.SQLException(22) 298 300 298 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 33), LineNumber(6, 35), LineNumber(9, 38), LineNumber(17, 39),  LineNumber(22, 42), LineNumber(30, 44), LineNumber(33, 50), LineNumber(35, 53),  LineNumber(41, 55), LineNumber(44, 56), LineNumber(47, 60), LineNumber(52, 61),  LineNumber(85, 62), LineNumber(97, 63), LineNumber(105, 65), LineNumber(135, 69),  LineNumber(157, 80), LineNumber(162, 82), LineNumber(169, 88), LineNumber(172, 85),  LineNumber(174, 87), LineNumber(187, 92), LineNumber(192, 94), LineNumber(199, 100),  LineNumber(202, 97), LineNumber(204, 99), LineNumber(217, 101), LineNumber(220, 72),  LineNumber(222, 74), LineNumber(235, 80), LineNumber(240, 82), LineNumber(247, 88),  LineNumber(250, 85), LineNumber(252, 87), LineNumber(265, 92), LineNumber(270, 94),  LineNumber(277, 100), LineNumber(280, 97), LineNumber(282, 99), LineNumber(295, 101),  LineNumber(298, 78), LineNumber(300, 80), LineNumber(305, 82), LineNumber(312, 88),  LineNumber(315, 85), LineNumber(317, 87), LineNumber(330, 92), LineNumber(335, 94),  LineNumber(342, 100), LineNumber(345, 97), LineNumber(347, 99), LineNumber(360, 100),  LineNumber(363, 103) LocalVariable(start_pc = 17, length = 13, index = 4:javax.servlet.http.Cookie[] cookieSources) LocalVariable(start_pc = 9, length = 24, index = 3:String data) LocalVariable(start_pc = 97, length = 60, index = 6:Boolean result) LocalVariable(start_pc = 174, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 204, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 222, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 252, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 282, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 317, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 347, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 44, length = 319, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 47, length = 316, index = 5:java.sql.PreparedStatement sqlStatement) LocalVariable(start_pc = 0, length = 364, index = 0:testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11 this) LocalVariable(start_pc = 0, length = 364, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 364, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 35, length = 329, index = 3:String data) StackMapTable((APPEND 1, offset delta=30, locals={(type=Object, class=java.lang.String)}), (CHOP 1, offset delta=2), (APPEND 1, offset delta=1, locals={(type=Object, class=java.lang.String)}), (APPEND 3, offset delta=99, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.PreparedStatement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (FULL, offset delta=2, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11), (type=Object, class=javax.servlet.http.HttpServletRequest), (type=Object, class=javax.servlet.http.HttpServletResponse), (type=Object, class=java.lang.String)})) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11" end="42" endBytecode="26" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" start="42" startBytecode="26" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11" end="61" endBytecode="67" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_prepareStatement_11.java" start="61" startBytecode="67" />
  </BugInstance>
  </BugCollection>