<BugCollection analysisTimestamp="1488587401892" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10" end="454" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" start="28" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10" end="109" endBytecode="1112" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" start="33" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10" end="63" endBytecode="90" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" start="63" startBytecode="90" />
    <String role="Sink method" value="Statement.executeQuery(...)" />
    <String role="Instruction Handle" value="  90: invokeinterface[185](5) 14" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {[?]+[[?]+[?]]}U1[1] {[?]+[[?]+[?]]}U2[0] {[?]+[[?]+[?]]}T3 {[NULL]+[[&quot;&quot;]+[getValue()]]}U4 {getDBConnection()}U5 {createStatement()}N6 {NULL}U7 {[?]+[[?]+[?]]}U8 {[?]+[[?]+[?]]}U9 {[?]+[[?]+[?]]}|U5 {createStatement()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 10, code_length = 404) 0:    getstatic  testcasesupport.IO.staticTrue Z (2) 3:    ifeq  #33 6:    ldc  &quot;&quot; (3) 8:    astore_3 9:    aload_1 10:   invokeinterface javax.servlet.http.HttpServletRequest.getCookies ()[Ljavax/servlet/http/Cookie; (4) 1 0 15:   astore  %4 17:   aload  %4 19:   ifnull  #30 22:   aload  %4 24:   iconst_0 25:   aaload 26:   invokevirtual javax.servlet.http.Cookie.getValue ()Ljava/lang/String; (5) 29:   astore_3 30:   goto  #35 33:   aconst_null 34:   astore_3 35:   getstatic  testcasesupport.IO.staticTrue Z (2) 38:   ifeq  #403 41:   aconst_null 42:   astore  %4 44:   aconst_null 45:   astore  %5 47:   aconst_null 48:   astore  %6 50:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (6) 53:   astore  %4 55:   aload  %4 57:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (7) 1 0 62:   astore  %5 64:   aload  %5 66:   new  &lt;java.lang.StringBuilder&gt; (8) 69:   dup 70:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (9) 73:   ldc  &quot;select * from users where name='&quot; (10) 75:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (11) 78:   aload_3 79:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (11) 82:   ldc  &quot;'&quot; (12) 84:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (11) 87:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (13) 90:   invokeinterface java.sql.Statement.executeQuery (Ljava/lang/String;)Ljava/sql/ResultSet; (14) 2 0 95:   astore  %6 97:   aload  %6 99:   invokeinterface java.sql.ResultSet.getRow ()I (15) 1 0 104:  invokestatic testcasesupport.IO.writeLine (I)V (16) 107:  aload  %6 109:  ifnull  #119 112:  aload  %6 114:  invokeinterface java.sql.ResultSet.close ()V (17) 1 0 119:  goto  #137 122:  astore  %7 124:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 127:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 130:  ldc  &quot;Error closing ResultSet&quot; (21) 132:  aload  %7 134:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 137:  aload  %5 139:  ifnull  #149 142:  aload  %5 144:  invokeinterface java.sql.Statement.close ()V (23) 1 0 149:  goto  #167 152:  astore  %7 154:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 157:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 160:  ldc  &quot;Error closing Statement&quot; (24) 162:  aload  %7 164:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 167:  aload  %4 169:  ifnull  #179 172:  aload  %4 174:  invokeinterface java.sql.Connection.close ()V (25) 1 0 179:  goto  #403 182:  astore  %7 184:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 187:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 190:  ldc  &quot;Error closing Connection&quot; (26) 192:  aload  %7 194:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 197:  goto  #403 200:  astore  %7 202:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 205:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 208:  ldc  &quot;Error getting database connection&quot; (27) 210:  aload  %7 212:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 215:  aload  %6 217:  ifnull  #227 220:  aload  %6 222:  invokeinterface java.sql.ResultSet.close ()V (17) 1 0 227:  goto  #245 230:  astore  %7 232:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 235:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 238:  ldc  &quot;Error closing ResultSet&quot; (21) 240:  aload  %7 242:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 245:  aload  %5 247:  ifnull  #257 250:  aload  %5 252:  invokeinterface java.sql.Statement.close ()V (23) 1 0 257:  goto  #275 260:  astore  %7 262:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 265:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 268:  ldc  &quot;Error closing Statement&quot; (24) 270:  aload  %7 272:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 275:  aload  %4 277:  ifnull  #287 280:  aload  %4 282:  invokeinterface java.sql.Connection.close ()V (25) 1 0 287:  goto  #403 290:  astore  %7 292:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 295:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 298:  ldc  &quot;Error closing Connection&quot; (26) 300:  aload  %7 302:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 305:  goto  #403 308:  astore  %8 310:  aload  %6 312:  ifnull  #322 315:  aload  %6 317:  invokeinterface java.sql.ResultSet.close ()V (17) 1 0 322:  goto  #340 325:  astore  %9 327:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 330:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 333:  ldc  &quot;Error closing ResultSet&quot; (21) 335:  aload  %9 337:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 340:  aload  %5 342:  ifnull  #352 345:  aload  %5 347:  invokeinterface java.sql.Statement.close ()V (23) 1 0 352:  goto  #370 355:  astore  %9 357:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 360:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 363:  ldc  &quot;Error closing Statement&quot; (24) 365:  aload  %9 367:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 370:  aload  %4 372:  ifnull  #382 375:  aload  %4 377:  invokeinterface java.sql.Connection.close ()V (25) 1 0 382:  goto  #400 385:  astore  %9 387:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (19) 390:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (20) 393:  ldc  &quot;Error closing Connection&quot; (26) 395:  aload  %9 397:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (22) 400:  aload  %8 402:  athrow 403:  return  Exception handler(s) =  From To Handler Type 107 119 122 java.sql.SQLException(18) 137 149 152 java.sql.SQLException(18) 167 179 182 java.sql.SQLException(18) 50 107 200 java.sql.SQLException(18) 215 227 230 java.sql.SQLException(18) 245 257 260 java.sql.SQLException(18) 275 287 290 java.sql.SQLException(18) 50 107 308 &lt;Any exception&gt;(0) 200 215 308 &lt;Any exception&gt;(0) 310 322 325 java.sql.SQLException(18) 340 352 355 java.sql.SQLException(18) 370 382 385 java.sql.SQLException(18) 308 310 308 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 33), LineNumber(6, 35), LineNumber(9, 38), LineNumber(17, 39),  LineNumber(22, 42), LineNumber(30, 44), LineNumber(33, 50), LineNumber(35, 53),  LineNumber(41, 55), LineNumber(44, 56), LineNumber(47, 57), LineNumber(50, 60),  LineNumber(55, 61), LineNumber(64, 63), LineNumber(97, 64), LineNumber(107, 74),  LineNumber(112, 76), LineNumber(119, 82), LineNumber(122, 79), LineNumber(124, 81),  LineNumber(137, 86), LineNumber(142, 88), LineNumber(149, 94), LineNumber(152, 91),  LineNumber(154, 93), LineNumber(167, 98), LineNumber(172, 100), LineNumber(179, 106),  LineNumber(182, 103), LineNumber(184, 105), LineNumber(197, 107), LineNumber(200, 66),  LineNumber(202, 68), LineNumber(215, 74), LineNumber(220, 76), LineNumber(227, 82),  LineNumber(230, 79), LineNumber(232, 81), LineNumber(245, 86), LineNumber(250, 88),  LineNumber(257, 94), LineNumber(260, 91), LineNumber(262, 93), LineNumber(275, 98),  LineNumber(280, 100), LineNumber(287, 106), LineNumber(290, 103), LineNumber(292, 105),  LineNumber(305, 107), LineNumber(308, 72), LineNumber(310, 74), LineNumber(315, 76),  LineNumber(322, 82), LineNumber(325, 79), LineNumber(327, 81), LineNumber(340, 86),  LineNumber(345, 88), LineNumber(352, 94), LineNumber(355, 91), LineNumber(357, 93),  LineNumber(370, 98), LineNumber(375, 100), LineNumber(382, 106), LineNumber(385, 103),  LineNumber(387, 105), LineNumber(400, 106), LineNumber(403, 109) LocalVariable(start_pc = 17, length = 13, index = 4:javax.servlet.http.Cookie[] cookieSources) LocalVariable(start_pc = 9, length = 24, index = 3:String data) LocalVariable(start_pc = 124, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 154, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 184, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 202, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 232, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 262, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 292, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 327, length = 13, index = 9:java.sql.SQLException exceptSql) LocalVariable(start_pc = 357, length = 13, index = 9:java.sql.SQLException exceptSql) LocalVariable(start_pc = 387, length = 13, index = 9:java.sql.SQLException exceptSql) LocalVariable(start_pc = 44, length = 359, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 47, length = 356, index = 5:java.sql.Statement sqlStatement) LocalVariable(start_pc = 50, length = 353, index = 6:java.sql.ResultSet resultSet) LocalVariable(start_pc = 0, length = 404, index = 0:testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10 this) LocalVariable(start_pc = 0, length = 404, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 404, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 35, length = 369, index = 3:String data) StackMapTable((APPEND 1, offset delta=30, locals={(type=Object, class=java.lang.String)}), (CHOP 1, offset delta=2), (APPEND 1, offset delta=1, locals={(type=Object, class=java.lang.String)}), (APPEND 3, offset delta=83, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement), (type=Object, class=java.sql.ResultSet)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (FULL, offset delta=2, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10), (type=Object, class=javax.servlet.http.HttpServletRequest), (type=Object, class=javax.servlet.http.HttpServletResponse), (type=Object, class=java.lang.String)})) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10" end="42" endBytecode="26" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" start="42" startBytecode="26" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10" end="63" endBytecode="79" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeQuery_10.java" start="63" startBytecode="79" />
  </BugInstance>
  </BugCollection>