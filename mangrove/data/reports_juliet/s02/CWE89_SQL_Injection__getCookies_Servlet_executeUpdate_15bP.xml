<BugCollection analysisTimestamp="1488586651661" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15" end="417" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" start="28" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15" isStatic="false" name="bad" signature="(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15" end="104" endBytecode="931" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" start="34" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15" end="65" endBytecode="114" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" start="65" startBytecode="114" />
    <String role="Sink method" value="Statement.executeUpdate(...)" />
    <String role="Instruction Handle" value=" 114: invokeinterface[185](5) 13" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[2] {[?]+[[?]+[?]]}U1[1] {[?]+[[?]+[?]]}U2[0] {[?]+[[?]+[?]]}T3 {[NULL]+[[&quot;&quot;]+[getValue()]]}U4 {getDBConnection()}U5 {createStatement()}U6 {[?]+[[?]+[?]]}U7 {[?]+[[?]+[?]]}U8 {[?]+[[?]+[?]]}|U5 {createStatement()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 364) 0:    bipush  6 2:    lookupswitch default = 47, npairs = 1 ((6, 20)) 20:   ldc  &quot;&quot; (2) 22:   astore_3 23:   aload_1 24:   invokeinterface javax.servlet.http.HttpServletRequest.getCookies ()[Ljavax/servlet/http/Cookie; (3) 1 0 29:   astore  %4 31:   aload  %4 33:   ifnull  #44 36:   aload  %4 38:   iconst_0 39:   aaload 40:   invokevirtual javax.servlet.http.Cookie.getValue ()Ljava/lang/String; (4) 43:   astore_3 44:   goto  #49 47:   aconst_null 48:   astore_3 49:   bipush  7 51:   lookupswitch default = 358, npairs = 1 ((7, 68)) 68:   aconst_null 69:   astore  %4 71:   aconst_null 72:   astore  %5 74:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (5) 77:   astore  %4 79:   aload  %4 81:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (6) 1 0 86:   astore  %5 88:   aload  %5 90:   new  &lt;java.lang.StringBuilder&gt; (7) 93:   dup 94:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (8) 97:   ldc  &quot;insert into users (status) values ('updated') where name='&quot; (9) 99:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 102:  aload_3 103:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 106:  ldc  &quot;'&quot; (11) 108:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 111:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (12) 114:  invokeinterface java.sql.Statement.executeUpdate (Ljava/lang/String;)I (13) 2 0 119:  istore  %6 121:  new  &lt;java.lang.StringBuilder&gt; (7) 124:  dup 125:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (8) 128:  ldc  &quot;Updated &quot; (14) 130:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 133:  iload  %6 135:  invokevirtual java.lang.StringBuilder.append (I)Ljava/lang/StringBuilder; (15) 138:  ldc  &quot; rows successfully.&quot; (16) 140:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (10) 143:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (12) 146:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (17) 149:  aload  %5 151:  ifnull  #161 154:  aload  %5 156:  invokeinterface java.sql.Statement.close ()V (18) 1 0 161:  goto  #179 164:  astore  %6 166:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (20) 169:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (21) 172:  ldc  &quot;Error closing Statement&quot; (22) 174:  aload  %6 176:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (23) 179:  aload  %4 181:  ifnull  #191 184:  aload  %4 186:  invokeinterface java.sql.Connection.close ()V (24) 1 0 191:  goto  #355 194:  astore  %6 196:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (20) 199:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (21) 202:  ldc  &quot;Error closing Connection&quot; (25) 204:  aload  %6 206:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (23) 209:  goto  #355 212:  astore  %6 214:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (20) 217:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (21) 220:  ldc  &quot;Error getting database connection&quot; (26) 222:  aload  %6 224:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (23) 227:  aload  %5 229:  ifnull  #239 232:  aload  %5 234:  invokeinterface java.sql.Statement.close ()V (18) 1 0 239:  goto  #257 242:  astore  %6 244:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (20) 247:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (21) 250:  ldc  &quot;Error closing Statement&quot; (22) 252:  aload  %6 254:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (23) 257:  aload  %4 259:  ifnull  #269 262:  aload  %4 264:  invokeinterface java.sql.Connection.close ()V (24) 1 0 269:  goto  #355 272:  astore  %6 274:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (20) 277:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (21) 280:  ldc  &quot;Error closing Connection&quot; (25) 282:  aload  %6 284:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (23) 287:  goto  #355 290:  astore  %7 292:  aload  %5 294:  ifnull  #304 297:  aload  %5 299:  invokeinterface java.sql.Statement.close ()V (18) 1 0 304:  goto  #322 307:  astore  %8 309:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (20) 312:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (21) 315:  ldc  &quot;Error closing Statement&quot; (22) 317:  aload  %8 319:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (23) 322:  aload  %4 324:  ifnull  #334 327:  aload  %4 329:  invokeinterface java.sql.Connection.close ()V (24) 1 0 334:  goto  #352 337:  astore  %8 339:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (20) 342:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (21) 345:  ldc  &quot;Error closing Connection&quot; (25) 347:  aload  %8 349:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (23) 352:  aload  %7 354:  athrow 355:  goto  #363 358:  ldc  &quot;Benign, fixed string&quot; (27) 360:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (17) 363:  return  Exception handler(s) =  From To Handler Type 149 161 164 java.sql.SQLException(19) 179 191 194 java.sql.SQLException(19) 74 149 212 java.sql.SQLException(19) 227 239 242 java.sql.SQLException(19) 257 269 272 java.sql.SQLException(19) 74 149 290 &lt;Any exception&gt;(0) 212 227 290 &lt;Any exception&gt;(0) 292 304 307 java.sql.SQLException(19) 322 334 337 java.sql.SQLException(19) 290 292 290 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 34), LineNumber(20, 37), LineNumber(23, 40), LineNumber(31, 41),  LineNumber(36, 44), LineNumber(44, 47), LineNumber(47, 51), LineNumber(49, 55),  LineNumber(68, 58), LineNumber(71, 59), LineNumber(74, 62), LineNumber(79, 63),  LineNumber(88, 65), LineNumber(121, 66), LineNumber(149, 76), LineNumber(154, 78),  LineNumber(161, 84), LineNumber(164, 81), LineNumber(166, 83), LineNumber(179, 88),  LineNumber(184, 90), LineNumber(191, 96), LineNumber(194, 93), LineNumber(196, 95),  LineNumber(209, 97), LineNumber(212, 68), LineNumber(214, 70), LineNumber(227, 76),  LineNumber(232, 78), LineNumber(239, 84), LineNumber(242, 81), LineNumber(244, 83),  LineNumber(257, 88), LineNumber(262, 90), LineNumber(269, 96), LineNumber(272, 93),  LineNumber(274, 95), LineNumber(287, 97), LineNumber(290, 74), LineNumber(292, 76),  LineNumber(297, 78), LineNumber(304, 84), LineNumber(307, 81), LineNumber(309, 83),  LineNumber(322, 88), LineNumber(327, 90), LineNumber(334, 96), LineNumber(337, 93),  LineNumber(339, 95), LineNumber(352, 96), LineNumber(355, 98), LineNumber(358, 101),  LineNumber(363, 104) LocalVariable(start_pc = 31, length = 13, index = 4:javax.servlet.http.Cookie[] cookieSources) LocalVariable(start_pc = 23, length = 24, index = 3:String data) LocalVariable(start_pc = 121, length = 28, index = 6:int rowCount) LocalVariable(start_pc = 166, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 196, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 214, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 244, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 274, length = 13, index = 6:java.sql.SQLException exceptSql) LocalVariable(start_pc = 309, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 339, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 71, length = 287, index = 4:java.sql.Connection dbConnection) LocalVariable(start_pc = 74, length = 284, index = 5:java.sql.Statement sqlStatement) LocalVariable(start_pc = 0, length = 364, index = 0:testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15 this) LocalVariable(start_pc = 0, length = 364, index = 1:javax.servlet.http.HttpServletRequest request) LocalVariable(start_pc = 0, length = 364, index = 2:javax.servlet.http.HttpServletResponse response) LocalVariable(start_pc = 49, length = 315, index = 3:String data) StackMapTable((SAME, offset delta=20), (APPEND 1, offset delta=23, locals={(type=Object, class=java.lang.String)}), (CHOP 1, offset delta=2), (APPEND 1, offset delta=1, locals={(type=Object, class=java.lang.String)}), (SAME, offset delta=18), (APPEND 2, offset delta=92, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=11), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (CHOP 2, offset delta=2), (CHOP 2, offset delta=2), (SAME, offset delta=4)) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15" end="44" endBytecode="40" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" start="44" startBytecode="40" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s02.CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15" end="65" endBytecode="103" sourcefile="CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" sourcepath="testcases/CWE89_SQL_Injection/s02/CWE89_SQL_Injection__getCookies_Servlet_executeUpdate_15.java" start="65" startBytecode="103" />
  </BugInstance>
  </BugCollection>