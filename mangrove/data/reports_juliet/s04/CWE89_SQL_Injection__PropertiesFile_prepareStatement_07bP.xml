<BugCollection analysisTimestamp="1488586985941" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07" end="500" sourcefile="CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" start="33" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07" isStatic="false" name="bad" signature="()V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07" end="135" endBytecode="1287" sourcefile="CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" start="43" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07" end="93" endBytecode="193" sourcefile="CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" start="93" startBytecode="193" />
    <String role="Sink method" value="Connection.prepareStatement(...)" />
    <String role="Instruction Handle" value=" 193: invokeinterface[185](5) 26" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[0] {[?]+[[[[[[?]+[?]]+[[?]+[?]]]+[[?]+[?]]]+[[?]+[?]]]+[?]]}T1 {[NULL]+[[[[[[&quot;&quot;]+[&quot;&quot;]]+[[&quot;&quot;]+[&quot;&quot;]]]+[[getProperty()]+[getProperty()]]]+[[&quot;&quot;]+[&quot;&quot;]]]+[getProperty()]]}U2 {getDBConnection()}N3 {NULL}U4 {[?]+[[[[[[[?]+[?]]+[?]]+[[[?]+[?]]+[?]]]+[[?]+[?]]]+[[?]+[?]]]+[[?]+[?]]]}U5 {[?]+[[[[[[?]+[?]]+[[?]+[?]]]+[[?]+[?]]]+[[?]+[?]]]+[?]]}U6 {[?]+[[[[[[?]+[?]]+[[?]+[?]]]+[[?]+[?]]]+[[?]+[?]]]+[?]]}U7 {[?]+[[[[[[?]+[?]]+[[?]+[?]]]+[[?]+[?]]]+[[?]+[?]]]+[?]]}U8 {[?]+[[[[[[?]+[?]]+[[?]+[?]]]+[[?]+[?]]]+[[?]+[?]]]+[?]]}|U2 {getDBConnection()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 9, code_length = 465) 0:    aload_0 1:    getfield  testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.privateFive I (2) 4:    iconst_5 5:    if_icmpne  #150 8:    ldc  &quot;&quot; (3) 10:   astore_1 11:   new  &lt;java.util.Properties&gt; (4) 14:   dup 15:   invokespecial java.util.Properties.&lt;init&gt; ()V (5) 18:   astore_2 19:   aconst_null 20:   astore_3 21:   new  &lt;java.io.FileInputStream&gt; (6) 24:   dup 25:   ldc  &quot;../common/config.properties&quot; (7) 27:   invokespecial java.io.FileInputStream.&lt;init&gt; (Ljava/lang/String;)V (8) 30:   astore_3 31:   aload_2 32:   aload_3 33:   invokevirtual java.util.Properties.load (Ljava/io/InputStream;)V (9) 36:   aload_2 37:   ldc  &quot;data&quot; (10) 39:   invokevirtual java.util.Properties.getProperty (Ljava/lang/String;)Ljava/lang/String; (11) 42:   astore_1 43:   aload_3 44:   ifnull  #51 47:   aload_3 48:   invokevirtual java.io.FileInputStream.close ()V (12) 51:   goto  #147 54:   astore  %4 56:   getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 59:   getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 62:   ldc  &quot;Error closing FileInputStream&quot; (16) 64:   aload  %4 66:   invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 69:   goto  #147 72:   astore  %4 74:   getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 77:   getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 80:   ldc  &quot;Error with stream reading&quot; (18) 82:   aload  %4 84:   invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 87:   aload_3 88:   ifnull  #95 91:   aload_3 92:   invokevirtual java.io.FileInputStream.close ()V (12) 95:   goto  #147 98:   astore  %4 100:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 103:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 106:  ldc  &quot;Error closing FileInputStream&quot; (16) 108:  aload  %4 110:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 113:  goto  #147 116:  astore  %5 118:  aload_3 119:  ifnull  #126 122:  aload_3 123:  invokevirtual java.io.FileInputStream.close ()V (12) 126:  goto  #144 129:  astore  %6 131:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 134:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 137:  ldc  &quot;Error closing FileInputStream&quot; (16) 139:  aload  %6 141:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 144:  aload  %5 146:  athrow 147:  goto  #152 150:  aconst_null 151:  astore_1 152:  aload_0 153:  getfield  testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.privateFive I (2) 156:  iconst_5 157:  if_icmpne  #464 160:  aconst_null 161:  astore_2 162:  aconst_null 163:  astore_3 164:  invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (19) 167:  astore_2 168:  aload_2 169:  new  &lt;java.lang.StringBuilder&gt; (20) 172:  dup 173:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (21) 176:  ldc  &quot;insert into users (status) values ('updated') where name='&quot; (22) 178:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (23) 181:  aload_1 182:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (23) 185:  ldc  &quot;'&quot; (24) 187:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (23) 190:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (25) 193:  invokeinterface java.sql.Connection.prepareStatement (Ljava/lang/String;)Ljava/sql/PreparedStatement; (26) 2 0 198:  astore_3 199:  aload_3 200:  invokeinterface java.sql.PreparedStatement.execute ()Z (27) 1 0 205:  invokestatic java.lang.Boolean.valueOf (Z)Ljava/lang/Boolean; (28) 208:  astore  %4 210:  aload  %4 212:  invokevirtual java.lang.Boolean.booleanValue ()Z (29) 215:  ifeq  #248 218:  new  &lt;java.lang.StringBuilder&gt; (20) 221:  dup 222:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (21) 225:  ldc  &quot;Name, &quot; (30) 227:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (23) 230:  aload_1 231:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (23) 234:  ldc  &quot;, updated successfully&quot; (31) 236:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (23) 239:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (25) 242:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (32) 245:  goto  #270 248:  new  &lt;java.lang.StringBuilder&gt; (20) 251:  dup 252:  invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (21) 255:  ldc  &quot;Unable to update records for user: &quot; (33) 257:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (23) 260:  aload_1 261:  invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (23) 264:  invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (25) 267:  invokestatic testcasesupport.IO.writeLine (Ljava/lang/String;)V (32) 270:  aload_3 271:  ifnull  #280 274:  aload_3 275:  invokeinterface java.sql.PreparedStatement.close ()V (34) 1 0 280:  goto  #298 283:  astore  %4 285:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 288:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 291:  ldc  &quot;Error closing PreparedStatement&quot; (36) 293:  aload  %4 295:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 298:  aload_2 299:  ifnull  #308 302:  aload_2 303:  invokeinterface java.sql.Connection.close ()V (37) 1 0 308:  goto  #464 311:  astore  %4 313:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 316:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 319:  ldc  &quot;Error closing Connection&quot; (38) 321:  aload  %4 323:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 326:  goto  #464 329:  astore  %4 331:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 334:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 337:  ldc  &quot;Error getting database connection&quot; (39) 339:  aload  %4 341:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 344:  aload_3 345:  ifnull  #354 348:  aload_3 349:  invokeinterface java.sql.PreparedStatement.close ()V (34) 1 0 354:  goto  #372 357:  astore  %4 359:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 362:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 365:  ldc  &quot;Error closing PreparedStatement&quot; (36) 367:  aload  %4 369:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 372:  aload_2 373:  ifnull  #382 376:  aload_2 377:  invokeinterface java.sql.Connection.close ()V (37) 1 0 382:  goto  #464 385:  astore  %4 387:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 390:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 393:  ldc  &quot;Error closing Connection&quot; (38) 395:  aload  %4 397:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 400:  goto  #464 403:  astore  %7 405:  aload_3 406:  ifnull  #415 409:  aload_3 410:  invokeinterface java.sql.PreparedStatement.close ()V (34) 1 0 415:  goto  #433 418:  astore  %8 420:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 423:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 426:  ldc  &quot;Error closing PreparedStatement&quot; (36) 428:  aload  %8 430:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 433:  aload_2 434:  ifnull  #443 437:  aload_2 438:  invokeinterface java.sql.Connection.close ()V (37) 1 0 443:  goto  #461 446:  astore  %8 448:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (14) 451:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (15) 454:  ldc  &quot;Error closing Connection&quot; (38) 456:  aload  %8 458:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (17) 461:  aload  %7 463:  athrow 464:  return  Exception handler(s) =  From To Handler Type 43 51 54 java.io.IOException(13) 21 43 72 java.io.IOException(13) 87 95 98 java.io.IOException(13) 21 43 116 &lt;Any exception&gt;(0) 72 87 116 &lt;Any exception&gt;(0) 118 126 129 java.io.IOException(13) 116 118 116 &lt;Any exception&gt;(0) 270 280 283 java.sql.SQLException(35) 298 308 311 java.sql.SQLException(35) 164 270 329 java.sql.SQLException(35) 344 354 357 java.sql.SQLException(35) 372 382 385 java.sql.SQLException(35) 164 270 403 &lt;Any exception&gt;(0) 329 344 403 &lt;Any exception&gt;(0) 405 415 418 java.sql.SQLException(35) 433 443 446 java.sql.SQLException(35) 403 405 403 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 43), LineNumber(8, 45), LineNumber(11, 48), LineNumber(19, 49),  LineNumber(21, 52), LineNumber(31, 53), LineNumber(36, 55), LineNumber(43, 66),  LineNumber(47, 68), LineNumber(51, 74), LineNumber(54, 71), LineNumber(56, 73),  LineNumber(69, 75), LineNumber(72, 57), LineNumber(74, 59), LineNumber(87, 66),  LineNumber(91, 68), LineNumber(95, 74), LineNumber(98, 71), LineNumber(100, 73),  LineNumber(113, 75), LineNumber(116, 64), LineNumber(118, 66), LineNumber(122, 68),  LineNumber(126, 74), LineNumber(129, 71), LineNumber(131, 73), LineNumber(144, 74),  LineNumber(147, 76), LineNumber(150, 82), LineNumber(152, 85), LineNumber(160, 87),  LineNumber(162, 88), LineNumber(164, 92), LineNumber(168, 93), LineNumber(199, 94),  LineNumber(210, 95), LineNumber(218, 97), LineNumber(248, 101), LineNumber(270, 112),  LineNumber(274, 114), LineNumber(280, 120), LineNumber(283, 117), LineNumber(285, 119),  LineNumber(298, 124), LineNumber(302, 126), LineNumber(308, 132), LineNumber(311, 129),  LineNumber(313, 131), LineNumber(326, 133), LineNumber(329, 104), LineNumber(331, 106),  LineNumber(344, 112), LineNumber(348, 114), LineNumber(354, 120), LineNumber(357, 117),  LineNumber(359, 119), LineNumber(372, 124), LineNumber(376, 126), LineNumber(382, 132),  LineNumber(385, 129), LineNumber(387, 131), LineNumber(400, 133), LineNumber(403, 110),  LineNumber(405, 112), LineNumber(409, 114), LineNumber(415, 120), LineNumber(418, 117),  LineNumber(420, 119), LineNumber(433, 124), LineNumber(437, 126), LineNumber(443, 132),  LineNumber(446, 129), LineNumber(448, 131), LineNumber(461, 132), LineNumber(464, 135)  LocalVariable(start_pc = 56, length = 13, index = 4:java.io.IOException exceptIO) LocalVariable(start_pc = 74, length = 13, index = 4:java.io.IOException exceptIO) LocalVariable(start_pc = 100, length = 13, index = 4:java.io.IOException exceptIO) LocalVariable(start_pc = 131, length = 13, index = 6:java.io.IOException exceptIO) LocalVariable(start_pc = 19, length = 128, index = 2:java.util.Properties properties) LocalVariable(start_pc = 21, length = 126, index = 3:java.io.FileInputStream streamFileInput) LocalVariable(start_pc = 11, length = 139, index = 1:String data) LocalVariable(start_pc = 210, length = 60, index = 4:Boolean result) LocalVariable(start_pc = 285, length = 13, index = 4:java.sql.SQLException exceptSql) LocalVariable(start_pc = 313, length = 13, index = 4:java.sql.SQLException exceptSql) LocalVariable(start_pc = 331, length = 13, index = 4:java.sql.SQLException exceptSql) LocalVariable(start_pc = 359, length = 13, index = 4:java.sql.SQLException exceptSql) LocalVariable(start_pc = 387, length = 13, index = 4:java.sql.SQLException exceptSql) LocalVariable(start_pc = 420, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 448, length = 13, index = 8:java.sql.SQLException exceptSql) LocalVariable(start_pc = 162, length = 302, index = 2:java.sql.Connection dbConnection) LocalVariable(start_pc = 164, length = 300, index = 3:java.sql.PreparedStatement sqlStatement) LocalVariable(start_pc = 0, length = 465, index = 0:testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07 this) LocalVariable(start_pc = 152, length = 313, index = 1:String data) StackMapTable((APPEND 3, offset delta=51, locals={(type=Object, class=java.lang.String), (type=Object, class=java.util.Properties), (type=Object, class=java.io.FileInputStream)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.io.IOException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.io.IOException)}), (SAME, offset delta=22), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.io.IOException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=9, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.io.IOException)}), (SAME, offset delta=14), (FULL, offset delta=2, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07), (type=Object, class=java.lang.String)}), (CHOP 1, offset delta=2), (APPEND 1, offset delta=1, locals={(type=Object, class=java.lang.String)}), (APPEND 3, offset delta=95, locals={(type=Object, class=java.sql.Connection), (type=Object, class=java.sql.PreparedStatement), (type=Object, class=java.lang.Boolean)}), (CHOP 1, offset delta=21), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=24), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (FULL, offset delta=11, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07), (type=Object, class=java.lang.String), (type=Object, class=java.sql.Connection), (type=Object, class=java.sql.PreparedStatement), (type=Bogus), (type=Bogus), (type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (FULL, offset delta=2, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07), (type=Object, class=java.lang.String)})) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07" end="53" endBytecode="33" sourcefile="CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" start="53" startBytecode="33" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07" end="55" endBytecode="39" sourcefile="CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" start="55" startBytecode="39" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__PropertiesFile_prepareStatement_07" end="93" endBytecode="187" sourcefile="CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__PropertiesFile_prepareStatement_07.java" start="93" startBytecode="187" />
  </BugInstance>
  </BugCollection>