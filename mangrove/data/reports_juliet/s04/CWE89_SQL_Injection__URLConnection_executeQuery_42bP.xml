<BugCollection analysisTimestamp="1488587661327" release="" sequence="0" timestamp="1487896524000" version="3.0.1">
  <BugInstance abbrev="SECSQLIJDBC" category="SECURITY" priority="1" rank="10" type="SQL_INJECTION_JDBC">
    <Class classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42" end="369" sourcefile="CWE89_SQL_Injection__URLConnection_executeQuery_42.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__URLConnection_executeQuery_42.java" start="34" />
    </Class>
    <Method classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42" isStatic="false" name="bad" signature="()V">
      <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42" end="155" endBytecode="969" sourcefile="CWE89_SQL_Injection__URLConnection_executeQuery_42.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__URLConnection_executeQuery_42.java" start="96" startBytecode="0" />
    </Method>
    <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42" end="108" endBytecode="48" sourcefile="CWE89_SQL_Injection__URLConnection_executeQuery_42.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__URLConnection_executeQuery_42.java" start="108" startBytecode="48" />
    <String role="Sink method" value="Statement.executeQuery(...)" />
    <String role="Instruction Handle" value="  48: invokeinterface[185](5) 32" />
    <String role="Parameter Taint" value="T {toString()}" />
    <String role="Taint Frame" value="[U0[0] {?}T1 {badSource()}U2 {getDBConnection()}U3 {createStatement()}N4 {NULL}U5 {?}U6 {?}U7 {?}|U3 {createStatement()}T {toString()}]" />
    <String role="Method Bytecode" value="Code(max_stack = 4, max_locals = 8, code_length = 350) 0:    aload_0 1:    invokespecial testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42.badSource ()Ljava/lang/String; (23) 4:    astore_1 5:    aconst_null 6:    astore_2 7:    aconst_null 8:    astore_3 9:    aconst_null 10:   astore  %4 12:   invokestatic testcasesupport.IO.getDBConnection ()Ljava/sql/Connection; (24) 15:   astore_2 16:   aload_2 17:   invokeinterface java.sql.Connection.createStatement ()Ljava/sql/Statement; (25) 1 0 22:   astore_3 23:   aload_3 24:   new  &lt;java.lang.StringBuilder&gt; (26) 27:   dup 28:   invokespecial java.lang.StringBuilder.&lt;init&gt; ()V (27) 31:   ldc  &quot;select * from users where name='&quot; (28) 33:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (29) 36:   aload_1 37:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (29) 40:   ldc  &quot;'&quot; (30) 42:   invokevirtual java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder; (29) 45:   invokevirtual java.lang.StringBuilder.toString ()Ljava/lang/String; (31) 48:   invokeinterface java.sql.Statement.executeQuery (Ljava/lang/String;)Ljava/sql/ResultSet; (32) 2 0 53:   astore  %4 55:   aload  %4 57:   invokeinterface java.sql.ResultSet.getRow ()I (33) 1 0 62:   invokestatic testcasesupport.IO.writeLine (I)V (34) 65:   aload  %4 67:   ifnull  #77 70:   aload  %4 72:   invokeinterface java.sql.ResultSet.close ()V (35) 1 0 77:   goto  #95 80:   astore  %5 82:   getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 85:   getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 88:   ldc  &quot;Error closing ResultSet&quot; (37) 90:   aload  %5 92:   invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 95:   aload_3 96:   ifnull  #105 99:   aload_3 100:  invokeinterface java.sql.Statement.close ()V (38) 1 0 105:  goto  #123 108:  astore  %5 110:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 113:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 116:  ldc  &quot;Error closing Statement&quot; (39) 118:  aload  %5 120:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 123:  aload_2 124:  ifnull  #133 127:  aload_2 128:  invokeinterface java.sql.Connection.close ()V (40) 1 0 133:  goto  #349 136:  astore  %5 138:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 141:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 144:  ldc  &quot;Error closing Connection&quot; (41) 146:  aload  %5 148:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 151:  goto  #349 154:  astore  %5 156:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 159:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 162:  ldc  &quot;Error getting database connection&quot; (42) 164:  aload  %5 166:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 169:  aload  %4 171:  ifnull  #181 174:  aload  %4 176:  invokeinterface java.sql.ResultSet.close ()V (35) 1 0 181:  goto  #199 184:  astore  %5 186:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 189:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 192:  ldc  &quot;Error closing ResultSet&quot; (37) 194:  aload  %5 196:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 199:  aload_3 200:  ifnull  #209 203:  aload_3 204:  invokeinterface java.sql.Statement.close ()V (38) 1 0 209:  goto  #227 212:  astore  %5 214:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 217:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 220:  ldc  &quot;Error closing Statement&quot; (39) 222:  aload  %5 224:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 227:  aload_2 228:  ifnull  #237 231:  aload_2 232:  invokeinterface java.sql.Connection.close ()V (40) 1 0 237:  goto  #349 240:  astore  %5 242:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 245:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 248:  ldc  &quot;Error closing Connection&quot; (41) 250:  aload  %5 252:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 255:  goto  #349 258:  astore  %6 260:  aload  %4 262:  ifnull  #272 265:  aload  %4 267:  invokeinterface java.sql.ResultSet.close ()V (35) 1 0 272:  goto  #290 275:  astore  %7 277:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 280:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 283:  ldc  &quot;Error closing ResultSet&quot; (37) 285:  aload  %7 287:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 290:  aload_3 291:  ifnull  #300 294:  aload_3 295:  invokeinterface java.sql.Statement.close ()V (38) 1 0 300:  goto  #318 303:  astore  %7 305:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 308:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 311:  ldc  &quot;Error closing Statement&quot; (39) 313:  aload  %7 315:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 318:  aload_2 319:  ifnull  #328 322:  aload_2 323:  invokeinterface java.sql.Connection.close ()V (40) 1 0 328:  goto  #346 331:  astore  %7 333:  getstatic  testcasesupport.IO.logger Ljava/util/logging/Logger; (16) 336:  getstatic  java.util.logging.Level.WARNING Ljava/util/logging/Level; (17) 339:  ldc  &quot;Error closing Connection&quot; (41) 341:  aload  %7 343:  invokevirtual java.util.logging.Logger.log (Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V (19) 346:  aload  %6 348:  athrow 349:  return  Exception handler(s) =  From To Handler Type 65 77 80 java.sql.SQLException(36) 95 105 108 java.sql.SQLException(36) 123 133 136 java.sql.SQLException(36) 12 65 154 java.sql.SQLException(36) 169 181 184 java.sql.SQLException(36) 199 209 212 java.sql.SQLException(36) 227 237 240 java.sql.SQLException(36) 12 65 258 &lt;Any exception&gt;(0) 154 169 258 &lt;Any exception&gt;(0) 260 272 275 java.sql.SQLException(36) 290 300 303 java.sql.SQLException(36) 318 328 331 java.sql.SQLException(36) 258 260 258 &lt;Any exception&gt;(0)  Attribute(s) =  LineNumber(0, 96), LineNumber(5, 98), LineNumber(7, 99), LineNumber(9, 100),  LineNumber(12, 104), LineNumber(16, 105), LineNumber(23, 108), LineNumber(55, 110),  LineNumber(65, 120), LineNumber(70, 122), LineNumber(77, 128), LineNumber(80, 125),  LineNumber(82, 127), LineNumber(95, 132), LineNumber(99, 134), LineNumber(105, 140),  LineNumber(108, 137), LineNumber(110, 139), LineNumber(123, 144), LineNumber(127, 146),  LineNumber(133, 152), LineNumber(136, 149), LineNumber(138, 151), LineNumber(151, 153),  LineNumber(154, 112), LineNumber(156, 114), LineNumber(169, 120), LineNumber(174, 122),  LineNumber(181, 128), LineNumber(184, 125), LineNumber(186, 127), LineNumber(199, 132),  LineNumber(203, 134), LineNumber(209, 140), LineNumber(212, 137), LineNumber(214, 139),  LineNumber(227, 144), LineNumber(231, 146), LineNumber(237, 152), LineNumber(240, 149),  LineNumber(242, 151), LineNumber(255, 153), LineNumber(258, 118), LineNumber(260, 120),  LineNumber(265, 122), LineNumber(272, 128), LineNumber(275, 125), LineNumber(277, 127),  LineNumber(290, 132), LineNumber(294, 134), LineNumber(300, 140), LineNumber(303, 137),  LineNumber(305, 139), LineNumber(318, 144), LineNumber(322, 146), LineNumber(328, 152),  LineNumber(331, 149), LineNumber(333, 151), LineNumber(346, 152), LineNumber(349, 155)  LocalVariable(start_pc = 82, length = 13, index = 5:java.sql.SQLException exceptSql) LocalVariable(start_pc = 110, length = 13, index = 5:java.sql.SQLException exceptSql) LocalVariable(start_pc = 138, length = 13, index = 5:java.sql.SQLException exceptSql) LocalVariable(start_pc = 156, length = 13, index = 5:java.sql.SQLException exceptSql) LocalVariable(start_pc = 186, length = 13, index = 5:java.sql.SQLException exceptSql) LocalVariable(start_pc = 214, length = 13, index = 5:java.sql.SQLException exceptSql) LocalVariable(start_pc = 242, length = 13, index = 5:java.sql.SQLException exceptSql) LocalVariable(start_pc = 277, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 305, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 333, length = 13, index = 7:java.sql.SQLException exceptSql) LocalVariable(start_pc = 0, length = 350, index = 0:testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42 this) LocalVariable(start_pc = 5, length = 345, index = 1:String data) LocalVariable(start_pc = 7, length = 343, index = 2:java.sql.Connection dbConnection) LocalVariable(start_pc = 9, length = 341, index = 3:java.sql.Statement sqlStatement) LocalVariable(start_pc = 12, length = 338, index = 4:java.sql.ResultSet resultSet) StackMapTable((FULL, offset delta=77, locals={(type=Object, class=testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42), (type=Object, class=java.lang.String), (type=Object, class=java.sql.Connection), (type=Object, class=java.sql.Statement), (type=Object, class=java.sql.ResultSet)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=26), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME_LOCALS_1_STACK, offset delta=17, stack items={(type=Object, class=java.lang.Throwable)}), (APPEND 2, offset delta=13, locals={(type=Bogus), (type=Object, class=java.lang.Throwable)}), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (SAME, offset delta=9), (SAME_LOCALS_1_STACK, offset delta=2, stack items={(type=Object, class=java.sql.SQLException)}), (SAME, offset delta=14), (CHOP 2, offset delta=2)) " />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42" end="56" endBytecode="47" sourcefile="CWE89_SQL_Injection__URLConnection_executeQuery_42.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__URLConnection_executeQuery_42.java" start="56" startBytecode="47" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42" end="96" endBytecode="1" sourcefile="CWE89_SQL_Injection__URLConnection_executeQuery_42.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__URLConnection_executeQuery_42.java" start="96" startBytecode="1" />
    <SourceLine classname="testcases.CWE89_SQL_Injection.s04.CWE89_SQL_Injection__URLConnection_executeQuery_42" end="108" endBytecode="45" sourcefile="CWE89_SQL_Injection__URLConnection_executeQuery_42.java" sourcepath="testcases/CWE89_SQL_Injection/s04/CWE89_SQL_Injection__URLConnection_executeQuery_42.java" start="108" startBytecode="45" />
  </BugInstance>
  </BugCollection>